filter(noun_onset>= -200 & noun_onset <= 500)%>%
mutate(pupil_period = case_when(noun_onset >= -200 & noun_onset <= 0 ~ "baseline",
TRUE ~ "post_onset")) %>%
group_by(subject_id, recording_name, trial_number, media_name, pupil_period)%>%
summarise(mean(pupil_right), na.rm=T) %>%
pivot_wider(names_from = pupil_period, values_from = "mean(pupil_right)") %>%
mutate(pupil_size_difference = post_onset - baseline)
View(pupil_dilation_right)
pupil_dilation_right <- kbh_data_clean %>%
filter(noun_onset>= -200 & noun_onset <= 500)%>%
mutate(pupil_period = case_when(noun_onset >= -200 & noun_onset <= 0 ~ "baseline",
TRUE ~ "post_onset")) %>%
group_by(subject_id, recording_name, trial_number, media_name, pupil_period)%>%
summarise(mean(pupil_right)) %>%
pivot_wider(names_from = pupil_period, values_from = "mean(pupil_right)") %>%
mutate(pupil_size_difference = post_onset - baseline)
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(dplyr)
library(stringr)
library(Hmisc)
library(corrplot)
library(tidyverse)
load(here("archival_KBH_anonimyzed/arch_final.Rda"))
kbh_data_clean <- arch_final%>%
group_by(studio_project_name, studio_test_name, trial_number, recording_name)%>%
mutate(trial_from_zero = recording_timestamp-min(recording_timestamp))%>%
group_by(studio_project_name)%>%
mutate(noun_onset = case_when(studio_project_name=="CompMix-36"~trial_from_zero-3000, #Substracting noun onset to normalize
studio_project_name=="LearnMix-36"~trial_from_zero-4500,
studio_project_name=="Mix-20"~trial_from_zero-5400,
studio_project_name=="Mix-14"~trial_from_zero-5400,
studio_project_name=="CogMisp-24"~trial_from_zero-1500))%>%
ungroup()%>%
rename(target_side=target, distractor_side=distractor,
gaze_point_x= gaze_point_x_adc_spx,
gaze_point_y = gaze_point_y_adc_spx)%>%
filter(gaze_point_x>=0 & gaze_point_x<= 1920)%>% #keeps only observations that are in the screen
filter(gaze_point_y>=0 & gaze_point_y<=1200)%>%
filter(!is.na(gaze_point_x))%>% #gets rid of the observations where tobii didn't get any reading
filter(!is.na(gaze_point_y))%>%
filter(!is.na(validity_left)) %>%
filter(!is.na(validity_right)) %>%
filter(validity_left<= 1)%>%
filter(validity_right <= 1)%>%
mutate(target = case_when(gaze_point_x >= target_x_min&gaze_point_x <= target_x_max&gaze_point_y >= target_y_min&gaze_point_y <= target_y_max~TRUE,
TRUE~FALSE))
#Create trial language column to describe the language in which the babies were tested
kbh_data_clean <- kbh_data_clean %>%
ungroup()%>%
group_by(studio_test_name, eng_exp, fre_exp)%>%
mutate(trial_lang = case_when(str_detect(studio_test_name,"E")~ "english",
str_detect(studio_test_name, "F")~ "french")) %>%
mutate(exp_to_target_lang = case_when(trial_lang == "english" ~ eng_exp,
trial_lang == "french" ~ fre_exp))
###### First, create variables that will be useful for the calculations below ##
distractor_initial_trials <- kbh_data_clean %>%
filter(noun_onset >= 260 & noun_onset <= 3000)%>%
mutate(initial_trial = case_when(
noun_onset >=260 & noun_onset <=360 & target==FALSE ~ "distractor_initial",
noun_onset >=260 & noun_onset <=360 & target==TRUE ~ "target_initial")
) %>%
group_by(recording_name, subject_id, trial_number, media_name, initial_trial) %>%
summarise() %>%
filter(initial_trial =="distractor_initial")
prop_looking <- kbh_data_clean %>%
filter(noun_onset>= 360 & noun_onset <= 3000)%>%
group_by(recording_name, subject_id, trial_number, media_name, age_months, exp_to_target_lang)%>%
summarise(samples_total=sum(target==TRUE, target==FALSE ),
samples_target=sum(target))%>%
mutate(prop_looking= samples_target/samples_total) %>%
ungroup()
pupil_dilation_right <- kbh_data_clean %>%
filter(noun_onset>= -200 & noun_onset <= 500)%>%
mutate(pupil_period = case_when(noun_onset >= -200 & noun_onset <= 0 ~ "baseline",
TRUE ~ "post_onset"))
View(pupil_dilation_right)
pupil_dilation_right <- kbh_data_clean %>%
filter(noun_onset>= -200 & noun_onset <= 500)%>%
mutate(pupil_period = case_when(noun_onset >= -200 & noun_onset <= 0 ~ "baseline",
TRUE ~ "post_onset"))%>%
group_by(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_dilation_right, pupil_dilation_left)
pupil_dilation_right <- kbh_data_clean %>%
filter(noun_onset>= -200 & noun_onset <= 500)%>%
mutate(pupil_period = case_when(noun_onset >= -200 & noun_onset <= 0 ~ "baseline",
TRUE ~ "post_onset"))%>%
select(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left)
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left)
pupil_dilation <- kbh_data_clean %>%
filter(noun_onset>= -200 & noun_onset <= 500)%>%
mutate(pupil_period = case_when(noun_onset >= -200 & noun_onset <= 0 ~ "baseline",
TRUE ~ "post_onset"))%>%
select(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left) %>%
drop_na(pupil_right) %>%
drop_na(pupil_left) #The next steps are confusing to me.Should we average baseline pupil? Should we contrast each post onset time slice to a partricular baseline time slice? We could use mean dilation, peak dilation (or peak amplitude), and/or peak latency (i.e., the time between onset and peak pupil dilation). The problem with mean dilation is that the baseline has less sampling than the post-onset. Could we do peak dilation of baseline vs. peak dilation post onset? Or peak dilation but from which baseline point? from peak? We will for sure do GCA's as extra analyses
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left)
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left) %>%
summarise(mean (pupil_right, pupil_left)) %>%
pivot_wider(names_from = pupil_period, values_from = "mean(pupil_right)") %>%
mutate(mean_pupil_size_difference = post_onset - baseline)
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left) %>%
summarise(mean=  c(pupil_right, pupil_left)) %>%
pivot_wider(names_from = pupil_period, values_from = "mean(pupil_right)") %>%
mutate(mean_pupil_size_difference = post_onset - baseline)
View(mean_dilation)
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left) %>%
summarise(mean=  c(pupil_right, pupil_left))
mean_dilation_right <- pupil_dilation %>%
ungroup() %>%
group_by(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left) %>%
mutate(two_pupil_mean = mean(pupil_right, pupil_left))
?mean
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left) %>%
mutate(two_pupil_mean = rowMeans (c(pupil_right, pupil_left)))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left) %>%
mutate(two_pupil_mean = rowMeans (select(c(pupil_right, pupil_left))))
?rowMeans
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left) %>%
mutate(two_pupil_mean = rowMeans(c(pupil_right, pupil_left)))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left) %>%
mutate(two_pupil_mean = rowMeans(c("pupil_right", "pupil_left")))
library(here)
library(dplyr)
library(stringr)
library(Hmisc)
library(corrplot)
library(tidyverse)
load(here("archival_KBH_anonimyzed/arch_final.Rda"))
kbh_data_clean <- arch_final%>%
group_by(studio_project_name, studio_test_name, trial_number, recording_name)%>%
mutate(trial_from_zero = recording_timestamp-min(recording_timestamp))%>%
group_by(studio_project_name)%>%
mutate(noun_onset = case_when(studio_project_name=="CompMix-36"~trial_from_zero-3000, #Substracting noun onset to normalize
studio_project_name=="LearnMix-36"~trial_from_zero-4500,
studio_project_name=="Mix-20"~trial_from_zero-5400,
studio_project_name=="Mix-14"~trial_from_zero-5400,
studio_project_name=="CogMisp-24"~trial_from_zero-1500))%>%
ungroup()%>%
rename(target_side=target, distractor_side=distractor,
gaze_point_x= gaze_point_x_adc_spx,
gaze_point_y = gaze_point_y_adc_spx)%>%
filter(gaze_point_x>=0 & gaze_point_x<= 1920)%>% #keeps only observations that are in the screen
filter(gaze_point_y>=0 & gaze_point_y<=1200)%>%
filter(!is.na(gaze_point_x))%>% #gets rid of the observations where tobii didn't get any reading
filter(!is.na(gaze_point_y))%>%
filter(!is.na(validity_left)) %>%
filter(!is.na(validity_right)) %>%
filter(validity_left<= 1)%>%
filter(validity_right <= 1)%>%
mutate(target = case_when(gaze_point_x >= target_x_min&gaze_point_x <= target_x_max&gaze_point_y >= target_y_min&gaze_point_y <= target_y_max~TRUE,
TRUE~FALSE))
#Create trial language column to describe the language in which the babies were tested
kbh_data_clean <- kbh_data_clean %>%
ungroup()%>%
group_by(studio_test_name, eng_exp, fre_exp)%>%
mutate(trial_lang = case_when(str_detect(studio_test_name,"E")~ "english",
str_detect(studio_test_name, "F")~ "french")) %>%
mutate(exp_to_target_lang = case_when(trial_lang == "english" ~ eng_exp,
trial_lang == "french" ~ fre_exp))
pupil_dilation <- kbh_data_clean %>%
filter(noun_onset>= -200 & noun_onset <= 500)%>%
mutate(pupil_period = case_when(noun_onset >= -200 & noun_onset <= 0 ~ "baseline",
TRUE ~ "post_onset"))%>%
select(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left) %>%
drop_na(pupil_right) %>%
drop_na(pupil_left) #The next steps are confusing to me.Should we average baseline pupil? Should we contrast each post onset time slice to a partricular baseline time slice? We could use mean dilation, peak dilation (or peak amplitude), and/or peak latency (i.e., the time between onset and peak pupil dilation). The problem with mean dilation is that the baseline has less sampling than the post-onset. Could we do peak dilation of baseline vs. peak dilation post onset? Or peak dilation but from which baseline point? from peak? We will for sure do GCA's as extra analyses
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left) %>%
mutate(two_pupil_mean = rowMeans(c("pupil_right", "pupil_left")))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left) %>%
mutate(two_pupil_mean = rowMeans(select(pupil_dilation,
c(pupil_right,pupil_left)), na.rm = TRUE))
str(pupil_dilation)
mean_dilation <- pupil_dilation %>%
ungroup() %>%
mutate(two_pupil_mean = rowMeans(select(pupil_dilation,
c(pupil_right,pupil_left)), na.rm = TRUE))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
mutate(two_pupil_mean = rowMeans(select(pupil_dilation,
c(as.numeric(pupil_right,pupil_left))), na.rm = TRUE))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
mutate(two_pupil_mean = rowMeans(select(pupil_dilation,
c(as.numeric(pupil_right),as.numeric(pupil_left))), na.rm = TRUE))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
mutate(pupil_right= as.numeric(pupil_right))
View(pupil_dilation)
mean_dilation <- pupil_dilation %>%
ungroup() %>%
mutate(pupil_right= as.numeric(pupil_right))%>%
mutate(pupil_left= as.numeric(pupil_left))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
mutate(pupil_right= as.numeric(pupil_right))%>%
mutate(pupil_left= as.numeric(pupil_left))%>%
mutate(two_pupil_mean = rowMeans(select(pupil_dilation,
c(pupil_right,pupil_left), na.rm = TRUE)))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
mutate(pupil_right= as.numeric(pupil_right))%>%
mutate(pupil_left= as.numeric(pupil_left))%>%
mutate(two_pupil_mean = rowMeans(select(pupil_dilation,
c(pupil_right,pupil_left))  na.rm = TRUE))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
mutate(pupil_right= as.numeric(pupil_right))%>%
mutate(pupil_left= as.numeric(pupil_left))%>%
mutate(two_pupil_mean = rowMeans(select(pupil_dilation,
c(pupil_right,pupil_left)),  na.rm = TRUE))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
mutate(pupil_right= as.numeric(pupil_right))%>%
mutate(pupil_left= as.numeric(pupil_left))%>%
mutate(two_pupil_mean = rowMeans(pupil_dilation$pupil_right, pupil_dilation$pupil_left))
pupil_dilation$two_pupil_mean <- rowMeans(data[c("pupil_right", "pupil_left")])
pupil_dilation$two_pupil_mean <- rowMeans(data[c("pupil_right", "pupil_left")])
pupil_dilation$two_pupil_mean <- rowMeans(pupil_dilation[c("pupil_right", "pupil_left")])
View(pupil_dilation)
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by( subject_id, recording_name, trial_number, media_name, pupil_period, two_pupil_mean)%>%
summarise(mean(two_pupil_mean)) %>%
pivot_wider(names_from = pupil_period, values_from = "mean(two_pupil_mean)") %>%
mutate(mean_pupil_size_difference = post_onset - baseline)
View(mean_dilation)
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by( subject_id, recording_name, trial_number, media_name, pupil_period, two_pupil_mean)%>%
summarise(mean(two_pupil_mean)) %>%
pivot_wider(names_from = pupil_period, values_from = "mean(two_pupil_mean)")
library(here)
library(dplyr)
library(stringr)
library(Hmisc)
library(corrplot)
library(tidyverse)
load(here("archival_KBH_anonimyzed/arch_final.Rda"))
kbh_data_clean <- arch_final%>%
group_by(studio_project_name, studio_test_name, trial_number, recording_name)%>%
mutate(trial_from_zero = recording_timestamp-min(recording_timestamp))%>%
group_by(studio_project_name)%>%
mutate(noun_onset = case_when(studio_project_name=="CompMix-36"~trial_from_zero-3000, #Substracting noun onset to normalize
studio_project_name=="LearnMix-36"~trial_from_zero-4500,
studio_project_name=="Mix-20"~trial_from_zero-5400,
studio_project_name=="Mix-14"~trial_from_zero-5400,
studio_project_name=="CogMisp-24"~trial_from_zero-1500))%>%
ungroup()%>%
rename(target_side=target, distractor_side=distractor,
gaze_point_x= gaze_point_x_adc_spx,
gaze_point_y = gaze_point_y_adc_spx)%>%
filter(gaze_point_x>=0 & gaze_point_x<= 1920)%>% #keeps only observations that are in the screen
filter(gaze_point_y>=0 & gaze_point_y<=1200)%>%
filter(!is.na(gaze_point_x))%>% #gets rid of the observations where tobii didn't get any reading
filter(!is.na(gaze_point_y))%>%
filter(!is.na(validity_left)) %>%
filter(!is.na(validity_right)) %>%
filter(validity_left<= 1)%>%
filter(validity_right <= 1)%>%
mutate(target = case_when(gaze_point_x >= target_x_min&gaze_point_x <= target_x_max&gaze_point_y >= target_y_min&gaze_point_y <= target_y_max~TRUE,
TRUE~FALSE))
#Create trial language column to describe the language in which the babies were tested
kbh_data_clean <- kbh_data_clean %>%
ungroup()%>%
group_by(studio_test_name, eng_exp, fre_exp)%>%
mutate(trial_lang = case_when(str_detect(studio_test_name,"E")~ "english",
str_detect(studio_test_name, "F")~ "french")) %>%
mutate(exp_to_target_lang = case_when(trial_lang == "english" ~ eng_exp,
trial_lang == "french" ~ fre_exp))
pupil_dilation <- kbh_data_clean %>%
filter(noun_onset>= -200 & noun_onset <= 500)%>%
mutate(pupil_period = case_when(noun_onset >= -200 & noun_onset <= 0 ~ "baseline",
TRUE ~ "post_onset"))%>%
select(subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left) %>%
drop_na(pupil_right) %>%
drop_na(pupil_left)
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by( subject_id, recording_name, trial_number, media_name, pupil_period, two_pupil_mean)%>%
summarise(mean(two_pupil_mean))
pupil_dilation$two_pupil_mean <- rowMeans(pupil_dilation[c("pupil_right", "pupil_left")]) #Adding a mean between left and right pupil.
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by( subject_id, recording_name, trial_number, media_name, pupil_period, two_pupil_mean)%>%
summarise(mean(two_pupil_mean))
View(mean_dilation)
ungroup() %>%
group_by( subject_id, recording_name, trial_number, media_name, pupil_period, two_pupil_mean)%>%
summarise(mean(two_pupil_mean)) %>%
pivot_wider(names_from = pupil_period, values_from = "mean(two_pupil_mean)")
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by( subject_id, recording_name, trial_number, media_name, pupil_period, two_pupil_mean)%>%
summarise(mean(two_pupil_mean)) %>%
pivot_wider(names_from = pupil_period, values_from = "mean(two_pupil_mean)")
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by( subject_id, recording_name, trial_number, media_name, pupil_period, two_pupil_mean)%>%
summarise(mean(two_pupil_mean))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by( subject_id, recording_name, trial_number, media_name, pupil_period, two_pupil_mean)%>%
pivot_wider(names_from = pupil_period, values_from = "mean(two_pupil_mean)")
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by( subject_id, recording_name, trial_number, media_name, pupil_period, two_pupil_mean)%>%
pivot_wider(names_from = pupil_period, values_from = "two_pupil_mean")
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by( subject_id, recording_name, trial_number, media_name, pupil_period, two_pupil_mean)
mean_dilation <- pupil_dilation %>%
ungroup() %>%
pivot_wider(names_from = pupil_period, values_from = "two_pupil_mean")
mean_dilation <- pupil_dilation %>%
ungroup() %>%
pivot_wider(names_from = pupil_period, values_from = "two_pupil_mean")%>%
group_by(pupil_period, two_pupil_mean) %>%
summarise(mean(two_pupil_mean))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(pupil_period, two_pupil_mean) %>%
summarise(mean(two_pupil_mean))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(pupil_period) %>%
summarise(mean(two_pupil_mean))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(pupil_period, recording_name, media_name) %>%
summarise(mean(two_pupil_mean))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(recording_name, media_name, pupil_period,) %>%
summarise(mean(two_pupil_mean))
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(recording_name, media_name, pupil_period,) %>%
summarise(mean(two_pupil_mean)) %>%
pivot_wider(names_from = pupil_period, values_from ="mean(two_pupil_mean)" )
mean_dilation <- pupil_dilation %>%
ungroup() %>%
group_by(recording_name, media_name, pupil_period,) %>%
summarise(mean(two_pupil_mean)) %>%
pivot_wider(names_from = pupil_period, values_from ="mean(two_pupil_mean)")%>%
mutate(mean_pupil_size_difference = post_onset - baseline) #difference in means
#Peak dilation
peak_dilation <- pupil_dilation %>%
ungroup()%>%
group_by(recording_name, media_name, pupil_period) %>%
summarise(max(two_pupil_mean))
View(peak_dilation)
View(mean_dilation)
#Peak dilation
peak_dilation <- pupil_dilation %>%
ungroup()%>%
group_by(recording_name, media_name, pupil_period) %>%
summarise(max(two_pupil_mean)) %>%
pivot_wider(names_from = pupil_period, values_from ="max(two_pupil_mean)")%>%
mutate(peak_pupil_size_difference = post_onset - baseline) #difference in peak pupil points
#Peak dilation
peak_dilation <- pupil_dilation %>%
ungroup()%>%
group_by(recording_name, media_name, pupil_period) %>%
summarise(max(two_pupil_mean)) %>%
pivot_wider(names_from = pupil_period, values_from ="max(two_pupil_mean)")
#Peak dilation
peak_dilation <- pupil_dilation %>%
ungroup()%>%
group_by(recording_name, media_name, pupil_period) %>%
summarise(max(two_pupil_mean)) %>%
pivot_wider(names_from = pupil_period, values_from ="max(two_pupil_mean)")%>%
mutate(peak_pupil_size_difference = post_onset - baseline) #difference in peak pupil points
View(pupil_dilation)
View(kbh_data_clean)
pupil_dilation <- kbh_data_clean %>%
filter(noun_onset>= -200 & noun_onset <= 500)%>%
mutate(pupil_period = case_when(noun_onset >= -200 & noun_onset <= 0 ~ "baseline",
TRUE ~ "post_onset"))%>%
select(recording_time_stamp, subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left) %>%
drop_na(pupil_right) %>%
drop_na(pupil_left)
pupil_dilation <- kbh_data_clean %>%
filter(noun_onset>= -200 & noun_onset <= 500)%>%
mutate(pupil_period = case_when(noun_onset >= -200 & noun_onset <= 0 ~ "baseline",
TRUE ~ "post_onset"))%>%
select(recording_timestamp, subject_id, recording_name, trial_number, media_name, pupil_period, pupil_right, pupil_left) %>%
drop_na(pupil_right) %>%
drop_na(pupil_left)
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_timestamp, recording_name, media_name, pupil_period) %>%
summarise(max(two_pupil_mean))
View(pupil_dilation)
pupil_dilation$two_pupil_mean <- rowMeans(pupil_dilation[c("pupil_right", "pupil_left")]) #Adding a mean between left and right pupil.
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_timestamp, recording_name, media_name, pupil_period) %>%
summarise(max(two_pupil_mean))
View(peak_pupil_latency)
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_timestamp, recording_name, media_name, pupil_period)
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_timestamp, recording_name, media_name, pupil_period) %>%
summarise(max(two_pupil_mean))
?summarise
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_timestamp, recording_name, media_name, pupil_period) %>%
summarise(max(two_pupil_mean)) %>%
summarise(max("max(two_pupil_mean)"))
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_timestamp, recording_name, media_name, pupil_period) %>%
summarise(max(two_pupil_mean)) %>%
summarise(max(max(two_pupil_mean)))
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_timestamp, recording_name, media_name, pupil_period) %>%
summarise(max(two_pupil_mean)) %>%
pivot_wider(names_from = pupil_period, values_from ="max(two_pupil_mean)")%>%
mutate(peak_pupil_size_difference = post_onset - baseline) #difference in peak pupil points
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_timestamp, recording_name, media_name, pupil_period) %>%
summarise(max(two_pupil_mean))
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_timestamp, recording_name, media_name, pupil_period) %>%
slice(which.max(two_pupil_mean))
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_name, media_name, pupil_period) %>%
slice(which.max(two_pupil_mean)) %>%
select(recording_name, media_name, pupil_period, peak_pupil= two_pupil_mean, corres_time_stamp = timestamp)
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_name, media_name, pupil_period) %>%
slice(which.max(two_pupil_mean)) %>%
select(recording_name, media_name, pupil_period, peak_pupil= two_pupil_mean, corres_time_stamp = recording_timestamp)
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_name, media_name, pupil_period) %>%
slice(which.max(two_pupil_mean)) %>%
select(recording_name, media_name, pupil_period, peak_pupil= two_pupil_mean, corres_time_stamp = recording_timestamp) %>%
pivot_wider(names_from = pupil_period, values_from =corres_time_stamp)
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_name, media_name, pupil_period) %>%
slice(which.max(two_pupil_mean)) %>%
select(recording_name, media_name, pupil_period, peak_pupil= two_pupil_mean, corres_time_stamp = recording_timestamp)
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_name, media_name, pupil_period) %>%
slice(which.max(two_pupil_mean)) %>%
select(recording_name, media_name, pupil_period, peak_time_stamp = recording_timestamp) %>%
#Slice is giving me only the max meassures of pupil, then I am selecting the timestamp corresponding to the max measures by baseline versus post_noun onset
pivot_wider(names_from = pupil_period, values_from =corres_time_stamp)
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_name, media_name, pupil_period) %>%
slice(which.max(two_pupil_mean)) %>%
select(recording_name, media_name, pupil_period, peak_time_stamp = recording_timestamp) %>%
#Slice is giving me only the max meassures of pupil, then I am selecting the timestamp corresponding to the max measures by baseline versus post_noun onset
pivot_wider(names_from = pupil_period, values_from =peak_time_stamp)
#peak latency
peak_pupil_latency <- pupil_dilation %>%
ungroup()%>%
group_by(recording_name, media_name, pupil_period) %>%
slice(which.max(two_pupil_mean)) %>%
select(recording_name, media_name, pupil_period, peak_time_stamp = recording_timestamp) %>%
#Slice is giving me only the max meassures of pupil, then I am selecting the timestamp corresponding to the max measures by baseline versus post_noun onset
pivot_wider(names_from = pupil_period, values_from =peak_time_stamp) %>%
mutate(peak_pupil_size_latency = post_onset - baseline) #time between baseline peak and post onset peak.
