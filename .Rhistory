word_type == "distractor_word" & distractor == TRUE ~ TRUE,
TRUE ~ FALSE)) %>%
group_by(recording_name, word_type, word) %>%
#what percent of the time when x is target are kids looking at x, what percent of the time when x is distractor are kids looking at x
summarise(prop_looking = sum(looking == T)/n())
prop_looking_diff %>%pivot_wider(names_from = "word_type", values_from = "word") %>% View()
prop_looking_diff %>%pivot_wider(names_from = "word_type", values_from = "prop_looking") %>% View()
prop_looking_diff %>%pivot_wider(names_from = "word_type", values_from = c("prop_looking", "word"), .id_cols = "recording_name") %>% View()
prop_looking_diff %>%pivot_wider(names_from = "word_type", values_from = c("prop_looking", "word"), id_cols = "recording_name") %>% View()
prop_looking_diff %>%pivot_wider(names_from = "word_type", values_from = c("word"), id_cols = "recording_name") %>% View()
prop_looking_diff %>%pivot_wider(names_from = "word_type", values_from = c("word")) %>% View()
prop_looking_diff %>% mutate(prefix = str_extract(word_type, "(?<=_).*"))
prop_looking_diff %>% mutate(prefix = str_remove(word_type, "_word"))
prop_looking_diff %>% mutate(prefix = str_remove(word_type, "_word")) %>% pivot_wider(names_from = c(word_type, prefix), values_from = c(word, prop_looking))
prop_looking_diff %>% mutate(prefix = str_remove(word_type, "_word")) %>% pivot_wider(names_from = c(word_type), values_from = c(word))
prop_looking_diff %>% pivot_wider(names_from = c(word_type), values_from = c(word))
prop_looking_diff %>% pivot_wider(names_from = c(word_type), values_from = c(word)) %>% View()
prop_looking_diff %>% pivot_wider(names_from = c(word_type), values_from = c(prop_looking)) %>% View()
prop_looking_diff %>% pivot_wider(id_cols = recording_name, names_from = word_type, names_glue = "{word_type}_{.value}",
values_from = c(word, prop_looking) %>% View()
prop_looking_diff %>% pivot_wider(id_cols = recording_name, names_from = word_type, names_glue = "{word_type}_{.value}",
values_from = c(word, prop_looking)) %>% View()
prop_looking_diff %>% pivot_wider(names_from = word_type, names_glue = "{word_type}_{.value}",
values_from = c(word, prop_looking)) %>% View()
# Step 1: Pivot the data to wide format based on word type
wide_data <- prop_looking_diff %>%
pivot_wider(names_from = word_type, values_from = c(word, proportion_looking))
# Step 1: Pivot the data to wide format based on word type
wide_data <- prop_looking_diff %>%
pivot_wider(names_from = word_type, values_from = c(word, prop_looking))
View(wide_data)
# Step 2: Rename the columns to match the desired format
colnames(wide_data) <- c("subject_id", "distractor_word", "target_word", "proportion_looking_distractor", "proportion_looking_target")
# Step 3: Pivot the data back to long format
long_data <- wide_data %>%
pivot_longer(cols = starts_with("proportion_looking"),
names_to = "word_type",
values_to = "proportion_looking") %>%
separate(word_type, into = c("word_type", "word"))
View(long_data)
# Step 4: Arrange the columns in the desired order
final_data <- long_data %>%
select(subject_id, word, word_type, proportion_looking) %>%
pivot_wider(names_from = word_type, values_from = proportion_looking)
View(final_data)
pivot_wider(names_from = word_type, values_from = word)
prop_looking_diff %>% pivot_wider(names_from = word_type, values_from = word)
prop_looking_diff %>% pivot_wider(names_from = word_type, values_from = word) %>% View()
prop_looking_diff %>% mutate(type = str_remove(word_type, "_word"), word_type = "word") %>% View()
prop_looking_diff %>% mutate(type = str_remove(word_type, "_word"), word_type = "word") %>% pivot_wider(names_from = type, values_from = c(word, prop_looking))
prop_looking_diff %>% mutate(type = str_remove(word_type, "_word"), word_type = "word") %>% pivot_wider(names_from = type, values_from = c(prop_looking))
prop_looking_diff %>% mutate(type = str_remove(word_type, "_word"), word_type = "word") %>% View()
prop_looking_diff %>% pivot_wider(names_from = word_type, values_from = c(prop_looking)) %>% View()
prop_looking_diff %>% pivot_wider(names_from = word_type, values_from = c(prop_looking)) %>% rename(prop_when_target_word_is_target = target_word, prop_when_target_word_is_distractor = distractor_word, target_word = word) %>% View()
prop_looking_diff %>% pivot_wider(names_from = word_type, values_from = c(prop_looking)) %>% r%>% View()
prop_looking_diff %>% pivot_wider(names_from = word_type, values_from = c(prop_looking)) %>%  View()
prop_looking_diff <- kbh_w_items %>%
ungroup()%>%
filter(noun_onset>= 360 & noun_onset <= 3000)%>%
select(recording_name, recording_timestamp, target_word, distractor_word, target, distractor)%>%
pivot_longer(c(target_word, distractor_word), names_to = "word_type", values_to = "word") %>%
mutate(looking = case_when(word_type == "target_word" & target == TRUE ~ TRUE,
word_type == "distractor_word" & distractor == TRUE ~ TRUE,
TRUE ~ FALSE)) %>%
group_by(recording_name, word_type, word) %>%
#what percent of the time when x is target are kids looking at x, what percent of the time when x is distractor are kids looking at x
summarise(prop_looking = sum(looking == T)/n()) %>%
pivot_wider(names_from = "word_type", values_from = "prop_looking")
prop_looking_diff <- kbh_w_items %>%
ungroup()%>%
filter(noun_onset>= 360 & noun_onset <= 3000)%>%
select(recording_name, recording_timestamp, target_word, distractor_word, target, distractor)%>%
pivot_longer(c(target_word, distractor_word), names_to = "word_type", values_to = "word") %>%
mutate(looking = case_when(word_type == "target_word" & target == TRUE ~ TRUE,
word_type == "distractor_word" & distractor == TRUE ~ TRUE,
TRUE ~ FALSE)) %>%
group_by(recording_name, word_type, word) %>%
#what percent of the time when x is target are kids looking at x, what percent of the time when x is distractor are kids looking at x
summarise(prop_looking = sum(looking == T)/n()) %>%
pivot_wider(names_from = "word_type", values_from = "prop_looking") %>%
filter(!is.na(target_word) & !is.na(distractor_word)) %>%
mutate(prop_looking_diff = target_word - distractor_word)
prop_looking_diff <- kbh_w_items %>%
ungroup()%>%
filter(noun_onset>= 360 & noun_onset <= 3000)%>%
select(recording_name, recording_timestamp, target_word, distractor_word, target, distractor)%>%
pivot_longer(c(target_word, distractor_word), names_to = "word_type", values_to = "word") %>%
mutate(looking = case_when(word_type == "target_word" & target == TRUE ~ TRUE,
word_type == "distractor_word" & distractor == TRUE ~ TRUE,
TRUE ~ FALSE)) %>%
group_by(recording_name, word_type, word) %>%
#what percent of the time when x is target are kids looking at x, what percent of the time when x is distractor are kids looking at x
summarise(prop_looking = sum(looking == T)/n()) %>%
pivot_wider(names_from = "word_type", values_from = "prop_looking") %>%
filter(!is.na(target_word) & !is.na(distractor_word)) %>%
mutate(prop_looking_diff = target_word - distractor_word) %>%
select(recording_name, target_word = word, prop_looking_diff)
?rle
200/17
200/16
rle(1:10)
rle(c(1:10, 1:10)
rle(c(1:10, 1:10))
rle(c(1:5, 1:5))
rle(c(1, 2, 1, 1, 2, 2, 3, 4, 2, 3, 3))
rle(c(1, 2, 1, 1, 2, 2, 2, 4, 2, 3, 3))
r$values & r$lengths
rle(c(1, 2, 1, 1, 2, 2, 2, 4, 2, 3, 3)) -> r
r$values & r$lengths
sum(r$values & r$lengths)
sum(r$values & r$lengths >= 12)
sum(r$values & r$lengths >= 12
sum(r$values & r$lengths >= 12)
sum(r$values & r$lengths >= 2)
#constum function to count how many consecutive blocks of looking to target there are each trial.
count_consecutive_blocks <- function(x) {
r <- rle(x)
sum(r$values & r$lengths >= 12) #this would be 200ms
}
kbh_w_items %>% select(trackloss)
kbh_w_items %>% select(trackloss) %>% mutate(test = cumsum(trackloss == TRUE)) %>% View()
kbh_w_items %>% select(trackloss) %>% mutate(test = data.table::rleid(trackloss)) %>% View()
kbh_w_items %>% ungroup() %>% select(trackloss) %>% mutate(test = data.table::rleid(trackloss)) %>% group_by(test) %>% mutate(test2 = n()) %>% View()
fixations_total2 <- kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2))
fixations_total <- kbh_w_items   %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
filter(!(lag(trackloss) == FALSE & trackloss == TRUE & lead(trackloss) == TRUE & lead(lead(trackloss))== FALSE))%>%  #This got rid of short tracklosses in a run
filter(!(trackloss == TRUE & lag(trackloss) == FALSE & lead(trackloss) == FALSE))%>%
group_by(recording_name, subject_id, trial_number, media_name)
View(fixations_total)
fixations_total %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss, consecutive_target) %>% left_join(fixations_total2 %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss, num_consec_tracloss_rows)) %>% View()
fixations_total %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss, consecutive_target) %>% left_join(fixations_total2 %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss, num_consec_tracloss_rows))
fixations_total <- kbh_w_items   %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
filter(!(lag(trackloss) == FALSE & trackloss == TRUE & lead(trackloss) == TRUE & lead(lead(trackloss))== FALSE))%>%  #This got rid of short tracklosses in a run
filter(!(trackloss == TRUE & lag(trackloss) == FALSE & lead(trackloss) == FALSE))%>%
group_by(recording_name, subject_id, trial_number, media_name) %>%
summarise(consecutive_target = count_consecutive_blocks(target))
fixations_total <- kbh_w_items   %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
filter(!(lag(trackloss) == FALSE & trackloss == TRUE & lead(trackloss) == TRUE & lead(lead(trackloss))== FALSE))%>%  #This got rid of short tracklosses in a run
filter(!(trackloss == TRUE & lag(trackloss) == FALSE & lead(trackloss) == FALSE))%>%
group_by(recording_name, subject_id, trial_number, media_name)
fixations_total %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss) %>% left_join(fixations_total2 %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss, num_consec_tracloss_rows)) %>% View()
fixations_total %>%ungroup() %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss) %>% left_join(fixations_total2 %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss, num_consec_tracloss_rows)) %>% View()
fixations_total %>%ungroup() %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss) %>% left_join(fixations_total2 %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss, num_consec_tracloss_rows))
fixations_total %>%ungroup() %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss) %>% left_join(fixations_total2 %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss, num_consec_trackloss_rows))
fixations_total %>%ungroup() %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss) %>% left_join(fixations_total2 %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss, num_consec_trackloss_rows)) %>% View()
fixations_total %>%ungroup() %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss) %>% mutate(source = "original") %>% left_join(fixations_total2 %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss, num_consec_trackloss_rows) %>% mutate(source = "new")) %>% View()
fixations_total %>%ungroup() %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss) %>% mutate(source = "original") %>% left_join(fixations_total2 %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss, num_consec_trackloss_rows)) %>% View()
fixations_total %>%ungroup() %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss) %>% mutate(source = "original") %>% full_join(fixations_total2 %>% select(recording_name, media_name, trial_number, recording_timestamp, trackloss, num_consec_trackloss_rows)) %>% View()
kbh_w_items %>% ungroup %>% count(trackloss)
test <- tibble(id = c(1, 1, 1, 2, 2, 2, 3, 3, 3), trackloss = c(T, T , F , F, T, F, T, T, F))
test
test %>%
mutate(trackloss_group_id = data.table::rleid(trackloss))
test %>% group_by(id) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss))
test %>% group_by(id) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, id) %>%
mutate(num_consec_trackloss_rows = n()) %>%
test %>% group_by(id) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, id) %>%
mutate(num_consec_trackloss_rows = n())
test %>% group_by(id) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, id) %>%
mutate(num_consec_trackloss_rows = n())
fixations_total2 <- kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2))
View(fixations_total2)
fixations_total2 %>% select(recording_name, trial_number, recording_timestamp, trackloss, trackloss_group_id, num_consec_trackloss_rows) %>% View()
range(fixations_total2$num_consec_trackloss_rows)
range(fixations_total2$num_consec_trackloss_rows[fixations_total2$trackloss == TRUE])
fixations_total2 %>% select(recording_name, trial_number, recording_timestamp, trackloss, trackloss_group_id, target, num_consec_trackloss_rows) %>% View()
fixations_total2 <- kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2)) %>%
group_by(recording_name, subject_id, trial_number, media_name) %>%
summarise(consecutive_target = count_consecutive_blocks(target))
View(fixations_total2)
fixations_total2 <- kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2)) %>%
group_by(recording_name, subject_id, trial_number, media_name)
rle(fixations_total2$target)
rle(fixations_total2$target) %>% View()
rle(fixations_total2$target)$lengths
kbh_w_items %>% filter(recording_name == "CompMix36_S01_88272000_F1" & trial_number == 1) %>% View()
367/12
fixations_total2 <- kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2)) %>%
group_by(recording_name, subject_id, trial_number, media_name) %>%
summarise(consecutive_target = count_consecutive_blocks(target))
View(fixations_total2)
fixations_total2 <- kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2)) %>%
group_by(recording_name, subject_id, trial_number, media_name) %>%
mutate(target_looks_group_id = data.table::rleid(trackloss)) %>%
group_by(target_looks_group_id, recording_name, trial_number) %>%
summarise(consecutive_target_looks = n())
fixations_total2 <- kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2)) %>%
group_by(recording_name, subject_id, trial_number, media_name) %>%
mutate(target_looks_group_id = data.table::rleid(trackloss)) %>%
group_by(target_looks_group_id, target, recording_name, trial_number) %>%
summarise(consecutive_target_looks = n())
fixations_total2 <- kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2)) %>%
group_by(recording_name, subject_id, trial_number, media_name) %>%
mutate(target_looks_group_id = data.table::rleid(trackloss))
fixations_total2 %>% select(recording_name, trial_number, trackloss, target, target_looks_group_id) %>% View()
fixations_total2 %>% select(recording_name, trial_number, recording_timestamp, trackloss, target, target_looks_group_id) %>% View()
fixations_total2 <- kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2)) %>%
group_by(recording_name, subject_id, trial_number, media_name) %>%
mutate(target_looks_group_id = data.table::rleid(target))
fixations_total2 %>% select(recording_name, trial_number, recording_timestamp, trackloss, target, target_looks_group_id) %>% View()
fixations_total2 %>% select(recording_name, trial_number, recording_timestamp, trackloss, target, target_looks_group_id) %>% filter(recording_name == "CompMix36_S01_88272000_F1") %>% View()
View(arch_final)
load(here("archival_KBH_anonimyzed/anonymized_eye_data/mix3.Rda"))
View(mix3)
12*10
fixations_total2 <- kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2))
12*16
fixations_total <- kbh_w_items   %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
filter(!(lag(trackloss) == FALSE & trackloss == TRUE & lead(trackloss) == TRUE & lead(lead(trackloss))== FALSE))%>%  #This got rid of short tracklosses in a run
filter(!(trackloss == TRUE & lag(trackloss) == FALSE & lead(trackloss) == FALSE))%>%
group_by(recording_name, subject_id, trial_number, media_name) %>%
summarise(consecutive_target = count_consecutive_blocks(target))
fixations_total2 <- kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2)) %>%
group_by(recording_name, subject_id, trial_number, media_name) %>%
mutate(target_looks_group_id = data.table::rleid(target))
fixations_total2 %>% select(recording_name, trial_number, recording_timestamp, target, target_looks_group_id) %>% filter(recording_name == "CompMix36_S01_88272000_F1") %>% View()
fixations_total2 %>% select(recording_name, trial_number, recording_timestamp, target, target_looks_group_id) %>% filter(recording_name == "CompMix36_S01_88272000_F1") %>% group_by(recording_name, trial_number, target_looks_group_id) %>% mutate(row = row_number()) %>% View()
fixations_total2 %>% select(recording_name, trial_number, recording_timestamp, target, target_looks_group_id) %>% filter(recording_name == "CompMix36_S01_88272000_F1") %>% group_by(recording_name, trial_number, target_looks_group_id) %>% mutate(row = row_number(), multi_of_twelve = case_when(row %% 12 == 0 ~ "fixation")) %>% View()
fixations_total2 %>% select(recording_name, trial_number, recording_timestamp, target, target_looks_group_id) %>% filter(recording_name == "CompMix36_S01_88272000_F1") %>% group_by(recording_name, trial_number, target_looks_group_id) %>% mutate(row = row_number(), multi_of_twelve = case_when(row %% 12 == 0 & target == TRUE ~ "fixation")) %>% View()
fixations_total2 <- kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2)) %>%
group_by(recording_name, trial_number, target_looks_group_id) %>%
mutate(row = row_number(),
multi_of_twelve = case_when(row %% 12 == 0 & target == TRUE ~ "fixation")) %>%
group_by(recording_name, subject_id, trial_number, media_name) %>%
summarise(consecutive_target = sum(multi_of_twelve == "fixation"))
fixations_total2 <- kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2)) %>%
group_by(recording_name, trial_number) %>%
mutate(row = row_number(),
multi_of_twelve = case_when(row %% 12 == 0 & target == TRUE ~ "fixation")) %>%
group_by(recording_name, subject_id, trial_number, media_name) %>%
summarise(consecutive_target = sum(multi_of_twelve == "fixation"))
fixations_total2 <- kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2)) %>%
group_by(recording_name, trial_number) %>%
mutate(row = row_number(),
multi_of_twelve = case_when(row %% 12 == 0 & target == TRUE ~ "fixation")) %>%
group_by(recording_name, subject_id, trial_number, media_name) %>%
summarise(consecutive_target = sum(multi_of_twelve == "fixation", na.rm = T))
kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2)) %>%
group_by(recording_name, trial_number) %>%
mutate(row = row_number(),
multi_of_twelve = case_when(row %% 12 == 0 & target == TRUE ~ "fixation")) %>% filter(recording_name %in% c("CompMix36_S01_88272000_F1", "1
CogMisp24_S01_540060000")) %>% filter(trial_number %in% c(2, 3, 6)) %>% View()
kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2)) %>%
group_by(recording_name, trial_number) %>%
mutate(row = row_number(),
multi_of_twelve = case_when(row %% 12 == 0 & target == TRUE ~ "fixation")) %>% filter(recording_name %in% c("CompMix36_S01_88272000_F1", "1
CogMisp24_S01_540060000")) %>% filter(trial_number %in% c(2, 3, 6)) %>% select(recording_name, trial_number, recording_timestamp, target, multi_of_twelve) %>% View()
kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2)) %>%
group_by(recording_name, trial_number) %>%
mutate(row = row_number(),
multi_of_twelve = case_when(row %% 12 == 0 & target == TRUE ~ "fixation")) %>% filter(recording_name %in% c("CompMix36_S01_88272000_F1", "CogMisp24_S01_540060000")) %>% filter(trial_number %in% c(2, 3, 6)) %>% select(recording_name, trial_number, recording_timestamp, target, multi_of_twelve) %>% View()
144/12
144 %% 12
fixations_total <- kbh_w_items   %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(trackloss_group_id = data.table::rleid(trackloss)) %>%
group_by(trackloss_group_id, recording_name, trial_number) %>%
mutate(num_consec_trackloss_rows = n()) %>%
ungroup() %>%
filter(trackloss == FALSE | (trackloss == TRUE & num_consec_trackloss_rows > 2)) %>%
group_by(recording_name, trial_number) %>%
mutate(row = row_number(),
multi_of_twelve = case_when(row %% 12 == 0 & target == TRUE ~ "fixation")) %>%
group_by(recording_name, subject_id, trial_number, media_name) %>%
summarise(consecutive_target = sum(multi_of_twelve == "fixation", na.rm = T))
rm(fixations_total2)
kbh_w_items%>% ungroup() %>% count(recording_name, trial_number, initial_look)
first_shift_target <- kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 1800) %>% #Keeping the shorter window to be consistent with Fernald
#Grouping and summarizing to get by subject by trial flagging of whether there was switching or not.
group_by(recording_name, subject_id, trial_number, media_name, initial_look) %>%
summarise(target = sum(target),
distractor =  sum(distractor)) %>% #Counting how many looks to target and distractor by timeslice grouped by target or distractor initial trials.
ungroup() %>%
mutate(correct_shift = case_when(initial_look == "target" & distractor ==0 ~ TRUE,
initial_look == "distractor" & target >0 ~ TRUE,
TRUE~FALSE)) #Making a column to calculate correct shifts. We defined correct shift as never looking to the distractor on target initial trial, or switching to the taget on distractor initial trials
View(first_shift_target)
isTRUE(TRUE)
isTRUE(5)
isTRUE(1)
1 == TRUE
?isTRUE
test <- first_shift_target %>%
filter(initial_look == "distractor") %>%
group_by(recording_name) %>%
summarise(sum (isTRUE(correct_shift))/n())
test2 <- first_shift_target %>%
filter(initial_look == "target") %>%
group_by(recording_name) %>%
summarise(sum (isTRUE(correct_shift))/n())
prop_shifts_distractor_initial <- first_shift_target %>%
filter(initial_look == "distractor") %>%
group_by(recording_name) %>%
summarise(sum (isTRUE(correct_shift))/sum((isTRUE(correct_shift)+ !isTRUE(correct_shift))))
prop_shifts_target_initial <- first_shift_target %>%
filter(initial_look == "target") %>%
group_by(recording_name) %>%
summarise(sum (isTRUE(correct_shift))/sum((isTRUE(correct_shift)+ !isTRUE(correct_shift))))
View(prop_shifts_distractor_initial)
View(test)
prop_shifts_distractor_initial <- first_shift_target %>%
filter(initial_look == "distractor") %>%
group_by(recording_name) %>%
summarise(prop_shift_distractor_initial = sum (isTRUE(correct_shift))/sum((isTRUE(correct_shift)+ !isTRUE(correct_shift))))
prop_shifts_target_initial <- first_shift_target %>%
filter(initial_look == "target") %>%
group_by(recording_name) %>%
summarise(prop_shift_target_initial = sum (isTRUE(correct_shift))/sum((isTRUE(correct_shift)+ !isTRUE(correct_shift))))
test <- first_shift_target %>%
filter(initial_look == "distractor") %>%
group_by(recording_name) %>%
summarise(prop_shift_distractor_initial = sum (isTRUE(correct_shift))/n())
test2 <- first_shift_target %>%
filter(initial_look == "target") %>%
group_by(recording_name) %>%
summarise(prop_shift_target_initial =sum (isTRUE(correct_shift))/n())
test <- first_shift_target %>% ungroup() %>%
filter(initial_look == "distractor") %>%
group_by(recording_name) %>%
summarise(prop_shift_distractor_initial = sum (isTRUE(correct_shift))/n())
test2 <- first_shift_target %>% ungroup() %>%
filter(initial_look == "target") %>%
group_by(recording_name) %>%
summarise(prop_shift_target_initial =sum (isTRUE(correct_shift))/n())
8/12
test <- first_shift_target %>% ungroup() %>%
filter(initial_look == "distractor") %>%
group_by(recording_name) %>%
summarise(prop_shift_distractor_initial = sum (correct_shift == TRUE)/n())
prop_shifts_distractor_initial <- first_shift_target %>%
filter(initial_look == "distractor") %>%
group_by(recording_name) %>%
summarise(prop_shift_distractor_initial = sum(correct_shift == TRUE)/n())
prop_shifts_target_initial <- first_shift_target %>%
filter(initial_look == "target") %>%
group_by(recording_name) %>%
summarise(prop_shift_target_initial = sum(correct_shift == TRUE)/n())
8/12
4/12
prop_shifts_distractor_initial <- first_shift_target %>%
filter(initial_look == "distractor") %>% View()
prop_shifts_distractor_initial <- first_shift_target %>%
filter(initial_look == "distractor") %>% View()
kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 1800) %>% #Keeping the shorter window to be consistent with Fernald
#Grouping and summarizing to get by subject by trial flagging of whether there was switching or not.
group_by(recording_name, subject_id, trial_number, media_name, initial_look) %>%  View()
kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 1800) %>% #Keeping the shorter window to be consistent with Fernald
#Grouping and summarizing to get by subject by trial flagging of whether there was switching or not.
filter(initial_look == "distractor") %>% View()
kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 1800) %>% #Keeping the shorter window to be consistent with Fernald
#Grouping and summarizing to get by subject by trial flagging of whether there was switching or not.
filter(initial_look == "distractor") %>%
group_by(recording_name, subject_id, trial_number, media_name, initial_look, target) %>%
slice_head() %>%
filter(target == TRUE) %>%
mutate(latency_to_switch = noun_onset - 360) %>% View()
