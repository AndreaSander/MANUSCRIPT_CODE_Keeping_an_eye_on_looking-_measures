mutate(targets_in_a_row = data.table::rleid(target)) %>%
group_by(recording_name, trial_number, targets_in_a_row) %>%
mutate(row = row_number(),
multi_of_twelve = case_when(row %% 12 == 0 ~ "fixation")) %>%
filter(multi_of_twelve == "fixation") %>%
mutate(where_looking = case_when(target == TRUE ~ "target",
distractor == TRUE ~ "distractor",
TRUE ~ "neither")) %>%
filter(where_looking != "neither") %>%
group_by(recording_name, trial_number) %>%
mutate(AOI_switches = case_when(lag(where_looking) == "target" & where_looking == "distractor" ~ 1,
lag(where_looking) == "distractor" & where_looking == "target" ~ 1))
kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(targets_in_a_row = data.table::rleid(target)) %>%
group_by(recording_name, trial_number, targets_in_a_row) %>%
mutate(row = row_number(),
multi_of_twelve = case_when(row %% 12 == 0 ~ "fixation")) %>%
mutate(where_looking = case_when(target == TRUE ~ "target",
distractor == TRUE ~ "distractor",
TRUE ~ "neither")) %>%
filter(where_looking != "neither") %>%
group_by(recording_name, trial_number) %>%
mutate(AOI_switches = case_when(lag(where_looking) == "target" & where_looking == "distractor" ~ 1,
lag(where_looking) == "distractor" & where_looking == "target" ~ 1))
kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(targets_in_a_row = data.table::rleid(target)) %>%
group_by(recording_name, trial_number, targets_in_a_row) %>%
mutate(row = row_number(),
multi_of_twelve = case_when(row %% 12 == 0 ~ "fixation")) %>%
mutate(where_looking = case_when(target == TRUE ~ "target",
distractor == TRUE ~ "distractor",
TRUE ~ "neither")) %>%
filter(where_looking != "neither") %>%
group_by(recording_name, trial_number) %>%
mutate(AOI_switches = case_when(lag(where_looking) == "target" & where_looking == "distractor" ~ 1,
lag(where_looking) == "distractor" & where_looking == "target" ~ 1)) %>% View()
kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(targets_in_a_row = data.table::rleid(target)) %>%
group_by(recording_name, trial_number, targets_in_a_row) %>%
mutate(row = row_number()) %>%
mutate(where_looking = case_when(target == TRUE ~ "target",
distractor == TRUE ~ "distractor",
TRUE ~ "neither")) %>%
group_by(recording_name, trial_number, where_looking) %>%
mutate(where_looking_id = data.table::rleid(where_looking)) %>% View()
kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(targets_in_a_row = data.table::rleid(target)) %>%
group_by(recording_name, trial_number, targets_in_a_row) %>%
mutate(row = row_number()) %>%
mutate(where_looking = case_when(target == TRUE ~ "target",
distractor == TRUE ~ "distractor",
TRUE ~ "neither")) %>%
group_by(recording_name, trial_number, where_looking) %>%
mutate(where_looking_id = data.table::rleid(where_looking))  %>% filter(where_looking_id == 2) %>% View()
kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(targets_in_a_row = data.table::rleid(target)) %>%
group_by(recording_name, trial_number, targets_in_a_row) %>%
mutate(row = row_number()) %>%
mutate(where_looking = case_when(target == TRUE ~ "target",
distractor == TRUE ~ "distractor",
TRUE ~ "neither")) %>%
group_by(recording_name, trial_number, where_looking) %>%
mutate(where_looking_id = data.table::rleid(where_looking)) %>% View()
kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(targets_in_a_row = data.table::rleid(target)) %>%
group_by(recording_name, trial_number, targets_in_a_row) %>%
mutate(row = row_number()) %>%
mutate(where_looking = case_when(target == TRUE ~ "target",
distractor == TRUE ~ "distractor",
TRUE ~ "neither")) %>%
filter(where_looking == "target") %>%
mutate(length_looking = max(row_number())) %>% View()
kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(targets_in_a_row = data.table::rleid(target)) %>%
group_by(recording_name, trial_number, targets_in_a_row) %>%
mutate(row = row_number()) %>%
mutate(where_looking = case_when(target == TRUE ~ "target",
distractor == TRUE ~ "distractor",
TRUE ~ "neither")) %>%
filter(where_looking == "target") %>%
mutate(length_looking = max(row_number())*(1000/16)) %>%
filter(targets_in_a_row == min(targets_in_a_row)) %>% View()
42*17
kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(targets_in_a_row = data.table::rleid(target)) %>%
group_by(recording_name, trial_number, targets_in_a_row) %>%
mutate(row = row_number()) %>%
mutate(where_looking = case_when(target == TRUE ~ "target",
distractor == TRUE ~ "distractor",
TRUE ~ "neither")) %>%
filter(where_looking == "target") %>%
mutate(length_looking = max(row_number())*(1000/60)) %>%
filter(targets_in_a_row == min(targets_in_a_row)) %>% View()
kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(targets_in_a_row = data.table::rleid(target)) %>%
group_by(recording_name, trial_number, targets_in_a_row) %>%
mutate(row = row_number()) %>%
mutate(where_looking = case_when(target == TRUE ~ "target",
distractor == TRUE ~ "distractor",
TRUE ~ "neither")) %>%
filter(where_looking == "target") %>%
mutate(length_first_look = max(row_number())*(1000/60)) %>%
filter(targets_in_a_row == min(targets_in_a_row)) %>%
distinct(recording_name, trial_number, media_name, length_first_look)
first_look_duration <- kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(targets_in_a_row = data.table::rleid(target)) %>%
group_by(recording_name, trial_number, targets_in_a_row) %>%
mutate(row = row_number()) %>%
mutate(where_looking = case_when(target == TRUE ~ "target",
distractor == TRUE ~ "distractor",
TRUE ~ "neither")) %>%
filter(where_looking == "target") %>%
mutate(first_look_dur = max(row_number())*(1000/60)) %>%
filter(targets_in_a_row == min(targets_in_a_row)) %>%
distinct(recording_name, trial_number, media_name, first_look_dur)
View(first_look_duration)
first_look_duration <- kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(targets_in_a_row = data.table::rleid(target)) %>%
group_by(recording_name, trial_number, targets_in_a_row) %>%
mutate(row = row_number()) %>%
mutate(where_looking = case_when(target == TRUE ~ "target",
distractor == TRUE ~ "distractor",
TRUE ~ "neither")) %>%
filter(where_looking == "target") %>%
mutate(first_look_dur = max(row_number())*(1000/60)) %>%
filter(targets_in_a_row == min(targets_in_a_row)) %>%
ungroup() %>%
distinct(recording_name, trial_number, media_name, first_look_dur)
View(mean_dilation)
mean_fixation_dur <- kbh_w_items %>%
filter(noun_onset>= 360 & noun_onset <= 3000)%>%
ungroup()%>%
group_by(recording_name, subject_id, trial_number, media_name) %>%
mutate(where_looking_group_id = data.table::rleid(target)) %>%
filter(target == TRUE) %>%
group_by(recording_name, trial_number, media_name, where_looking_group_id) %>%
summarise(length_of_looks = n()) %>%
mutate(length_of_looks = length_of_looks*(1000/60)) %>%
group_by(recording_name, trial_number, media_name) %>%
summarise(duration_of_look = mean(length_of_looks, na.rm = T)) %>%
ungroup()
View(mean_fixation_dur)
1789*2
first_look_duration %>% arrange(recording_name, trial_number) %>% View()
kbh_w_items %>%
filter(noun_onset>= 360 & noun_onset <= 3000)%>%
ungroup()%>%
group_by(recording_name, subject_id, trial_number, media_name) %>%
mutate(where_looking_group_id = data.table::rleid(target)) %>%
filter(target == TRUE) %>%
group_by(recording_name, trial_number, media_name, where_looking_group_id) %>%
summarise(length_of_looks = n()) %>%
mutate(length_of_looks = length_of_looks*(1000/60)) %>%View()
kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(targets_in_a_row = data.table::rleid(target)) %>%
group_by(recording_name, trial_number, targets_in_a_row) %>%
mutate(row = row_number()) %>%
mutate(where_looking = case_when(target == TRUE ~ "target",
distractor == TRUE ~ "distractor",
TRUE ~ "neither")) %>%
filter(where_looking == "target") %>%
mutate(first_look_dur = max(row_number())*(1000/60)) %>% View()
first_look_duration <- kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(targets_in_a_row = data.table::rleid(target)) %>%
group_by(recording_name, trial_number, targets_in_a_row) %>%
mutate(row = row_number()) %>%
mutate(where_looking = case_when(target == TRUE ~ "target",
distractor == TRUE ~ "distractor",
TRUE ~ "neither")) %>%
filter(where_looking == "target") %>%
mutate(first_look_dur = max(row_number())*(1000/60)) %>%
group_by(recording_name, trial_number) %>%
filter(targets_in_a_row == min(targets_in_a_row)) %>%
ungroup() %>%
distinct(recording_name, trial_number, media_name, first_look_dur)
View(first_look_duration)
first_look_duration <- kbh_w_items %>%
ungroup() %>%
filter(noun_onset >= 360 & noun_onset <= 3000) %>%
group_by(recording_name, trial_number) %>%
mutate(targets_in_a_row = data.table::rleid(target)) %>%
group_by(recording_name, trial_number, targets_in_a_row) %>%
mutate(row = row_number()) %>%
mutate(where_looking = case_when(target == TRUE ~ "target",
distractor == TRUE ~ "distractor",
TRUE ~ "neither")) %>%
filter(where_looking == "target") %>%
mutate(first_look_dur = max(row_number())*(1000/60)) %>%
filter(first_look_dur >= 200) %>%
group_by(recording_name, trial_number) %>%
filter(targets_in_a_row == min(targets_in_a_row)) %>%
ungroup() %>%
distinct(recording_name, trial_number, media_name, first_look_dur)
copy_data <- kbh_w_items %>%
filter(noun_onset>= -2000 & noun_onset <= 3000)%>%
mutate(timestamp_zero_interest_period = noun_onset - 360,
trial_unique = paste0(recording_name, "_", trial_number, "_", media_name)) %>%
ungroup()%>%
group_by(recording_name, trial_number, media_name) %>%
mutate(new_noun_onset = case_when(abs(noun_onset) == min(abs(noun_onset)) ~ 0)) %>% select(recording_name, trial_number, recording_timestamp, trial_from_zero, noun_onset, new_noun_onset) %>%
mutate(new_timestamp = (row_number() - which(new_noun_onset == 0))*(1000/60),
new_timestamp = round(new_timestamp))
View(copy_data)
kbh_w_items %>%
filter(noun_onset>= -2000 & noun_onset <= 3000)%>%
mutate(timestamp_zero_interest_period = noun_onset - 360,
trial_unique = paste0(recording_name, "_", trial_number, "_", media_name)) %>%
ungroup()%>%
group_by(recording_name, trial_number, media_name) %>%
mutate(new_noun_onset = case_when(abs(noun_onset) == min(abs(noun_onset)) ~ 0)) %>% select(recording_name, trial_number, recording_timestamp, trial_from_zero, noun_onset, new_noun_onset) %>%
mutate(parallel_timestamp = (row_number() - which(new_noun_onset == 0))*(1000/60),
parallel_timestamp = round(parallel_timestamp)) %>% View()
copy_data <- kbh_w_items %>%
filter(noun_onset>= -2000 & noun_onset <= 3000)%>%
mutate(timestamp_zero_interest_period = noun_onset - 360,
trial_unique = paste0(recording_name, "_", trial_number, "_", media_name)) %>%
ungroup()%>%
group_by(recording_name, trial_number, media_name) %>%
mutate(new_noun_onset = case_when(abs(noun_onset) == min(abs(noun_onset)) ~ 0)) %>%
select(recording_name, trial_number, recording_timestamp, trial_from_zero, noun_onset, new_noun_onset, target, distractor) %>%
mutate(parallel_timestamp = (row_number() - which(new_noun_onset == 0))*(1000/60),
parallel_timestamp = round(parallel_timestamp)) %>%
select(media_name, recording_name, trial_number, parallel_timestamp, target, distractor)
dat_raw %>% arrange(participant, item, Time) %>% View()
dat_raw %>% arrange(Participant, Item, Time) %>% View()
copy_data <- kbh_w_items %>%
filter(noun_onset>= -2000 & noun_onset <= 3000)%>%
mutate(timestamp_zero_interest_period = noun_onset - 360,
trial_unique = paste0(recording_name, "_", trial_number, "_", media_name)) %>%
ungroup()%>%
group_by(recording_name, trial_number, media_name) %>%
mutate(new_noun_onset = case_when(abs(noun_onset) == min(abs(noun_onset)) ~ 0)) %>%
select(recording_name, trial_number, recording_timestamp, trial_from_zero, noun_onset, new_noun_onset, target, distractor) %>%
mutate(parallel_timestamp = (row_number() - which(new_noun_onset == 0))*(1000/60),
parallel_timestamp = round(parallel_timestamp)) %>%
select(media_name, recording_name, trial_number, parallel_timestamp, target, distractor) %>%
pivot_longer(c(target, distractor), names_to = "aoi", values_to = "value")
copy_data <- kbh_w_items %>%
filter(noun_onset>= -2000 & noun_onset <= 3000)%>%
mutate(timestamp_zero_interest_period = noun_onset - 360,
trial_unique = paste0(recording_name, "_", trial_number, "_", media_name)) %>%
ungroup()%>%
group_by(recording_name, trial_number, media_name) %>%
mutate(new_noun_onset = case_when(abs(noun_onset) == min(abs(noun_onset)) ~ 0)) %>%
select(recording_name, trial_number, recording_timestamp, trial_from_zero, noun_onset, new_noun_onset, target, distractor) %>%
mutate(parallel_timestamp = (row_number() - which(new_noun_onset == 0))*(1000/60),
parallel_timestamp = round(parallel_timestamp)) %>%
select(media_name, recording_name, trial_number, parallel_timestamp, target, distractor) %>%
pivot_longer(c(target, distractor), names_to = "aoi", values_to = "value") %>%
arrange(recording_name, trial_number, aoi, parallel_timestamp) %>%
mutate(value = as.numeric(value))
copy_data <- kbh_w_items %>%
filter(noun_onset>= -2000 & noun_onset <= 3000)%>%
mutate(timestamp_zero_interest_period = noun_onset - 360,
trial_unique = paste0(recording_name, "_", trial_number, "_", media_name)) %>%
ungroup()%>%
group_by(recording_name, trial_number, media_name) %>%
mutate(new_noun_onset = case_when(abs(noun_onset) == min(abs(noun_onset)) ~ 0)) %>%
select(recording_name, trial_number, recording_timestamp, trial_from_zero, noun_onset, new_noun_onset, target, distractor, trackloss) %>%
mutate(parallel_timestamp = (row_number() - which(new_noun_onset == 0))*(1000/60),
parallel_timestamp = round(parallel_timestamp)) %>%
select(media_name, recording_name, trial_number, parallel_timestamp, target, distractor, trackloss) %>%
pivot_longer(c(target, distractor), names_to = "aoi", values_to = "value") %>%
arrange(recording_name, trial_number, aoi, parallel_timestamp) %>%
mutate(value = as.numeric(value))
copy_data <- kbh_w_items %>%
filter(noun_onset>= -2000 & noun_onset <= 3000)%>%
mutate(timestamp_zero_interest_period = noun_onset - 360,
trial_unique = paste0(recording_name, "_", trial_number, "_", media_name)) %>%
ungroup()%>%
group_by(recording_name, trial_number, media_name) %>%
mutate(new_noun_onset = case_when(abs(noun_onset) == min(abs(noun_onset)) ~ 0)) %>%
select(recording_name, trial_number, recording_timestamp, trial_from_zero, noun_onset, new_noun_onset, target, distractor, trackloss) %>%
mutate(parallel_timestamp = (row_number() - which(new_noun_onset == 0))*(1000/60),
parallel_timestamp = round(parallel_timestamp)) %>%
select(media_name, recording_name, trial_number, parallel_timestamp, target, distractor, trackloss) %>%
pivot_longer(c(target, distractor), names_to = "aoi", values_to = "value") %>%
arrange(recording_name, trial_number, aoi, parallel_timestamp) %>%
mutate(value = as.numeric(value)) %>%
filter(trackloss == FALSE)
copy_dat_fig1 <- copy_data %>%
group_by(recording_name, aoi, parallel_timestamp) %>%
summarise(mean_fixation = mean(value))
View(copy_dat_fig1)
ggplot(copy_dat_fig1, aes(x=parallel_timestamp, y=mean_fixation, colour=aoi)) +
geom_vline(xintercept=0, linetype="dashed", colour="gray28") +
stat_summary(fun.data=mean_cl_boot, aes(fill=aoi),
geom="ribbon", alpha=.2, linetype="blank") +
stat_summary(fun=mean, geom="path",
aes(group=aoi, linetype=aoi), size=.7)
copy_data <- kbh_w_items %>%
filter(noun_onset>= -2000 & noun_onset <= 3000)%>%
mutate(timestamp_zero_interest_period = noun_onset - 360,
trial_unique = paste0(recording_name, "_", trial_number, "_", media_name)) %>%
ungroup()%>%
group_by(recording_name, trial_number, media_name, age_months) %>%
mutate(new_noun_onset = case_when(abs(noun_onset) == min(abs(noun_onset)) ~ 0)) %>%
select(recording_name, trial_number, recording_timestamp, trial_from_zero, noun_onset, new_noun_onset, target, distractor, trackloss, age_months) %>%
mutate(parallel_timestamp = (row_number() - which(new_noun_onset == 0))*(1000/60),
parallel_timestamp = round(parallel_timestamp)) %>%
select(media_name, recording_name, trial_number, parallel_timestamp, target, distractor, trackloss, age_months) %>%
pivot_longer(c(target, distractor), names_to = "aoi", values_to = "value") %>%
arrange(recording_name, trial_number, aoi, parallel_timestamp) %>%
mutate(value = as.numeric(value)) %>%
filter(trackloss == FALSE)
copy_data %>% count(age_months)
copy_data <- kbh_w_items %>%
filter(noun_onset>= -2000 & noun_onset <= 3000)%>%
mutate(timestamp_zero_interest_period = noun_onset - 360,
trial_unique = paste0(recording_name, "_", trial_number, "_", media_name)) %>%
ungroup()%>%
group_by(recording_name, trial_number, media_name, age_months) %>%
mutate(new_noun_onset = case_when(abs(noun_onset) == min(abs(noun_onset)) ~ 0)) %>%
select(recording_name, trial_number, recording_timestamp, trial_from_zero, noun_onset, new_noun_onset, target, distractor, trackloss, age_months) %>%
mutate(parallel_timestamp = (row_number() - which(new_noun_onset == 0))*(1000/60),
parallel_timestamp = round(parallel_timestamp)) %>%
select(media_name, recording_name, trial_number, parallel_timestamp, target, distractor, trackloss, age_months) %>%
pivot_longer(c(target, distractor), names_to = "aoi", values_to = "value") %>%
arrange(recording_name, trial_number, aoi, parallel_timestamp) %>%
mutate(value = as.numeric(value)) %>%
filter(trackloss == FALSE) %>%
ungroup()
copy_data %>% count(age_group)
copy_data %>% count(age_months)
copy_data %>% mutate(age_months = round(age_months)) %>% count(age_months)
copy_data %>% mutate(age_months = round(age_months)) %>% count(age_months) %>% View()
copy_data <- kbh_w_items %>%
filter(noun_onset>= -2000 & noun_onset <= 3000)%>%
mutate(timestamp_zero_interest_period = noun_onset - 360,
trial_unique = paste0(recording_name, "_", trial_number, "_", media_name)) %>%
ungroup()%>%
group_by(recording_name, trial_number, media_name, age_months) %>%
mutate(new_noun_onset = case_when(abs(noun_onset) == min(abs(noun_onset)) ~ 0)) %>%
select(recording_name, trial_number, recording_timestamp, trial_from_zero, noun_onset, new_noun_onset, target, distractor, trackloss, age_months) %>%
mutate(parallel_timestamp = (row_number() - which(new_noun_onset == 0))*(1000/60),
parallel_timestamp = round(parallel_timestamp)) %>%
select(media_name, recording_name, trial_number, parallel_timestamp, target, distractor, trackloss, age_months) %>%
pivot_longer(c(target, distractor), names_to = "aoi", values_to = "value") %>%
arrange(recording_name, trial_number, aoi, parallel_timestamp) %>%
mutate(value = as.numeric(value)) %>%
filter(trackloss == FALSE) %>%
ungroup() %>%
mutate(age_group = case_when(age_months >= 14 & age_months < 21 ~ "14-20",
age_months >= 21 & age_months < 30 ~ "21-30",
age_months >= 31 & age_months < 49 ~ "31-48"))
copy_data %>% count(age_group)
copy_data %>% filter(is.na(age_group)) %>% count(age_months)
copy_data <- kbh_w_items %>%
filter(noun_onset>= -2000 & noun_onset <= 3000)%>%
mutate(timestamp_zero_interest_period = noun_onset - 360,
trial_unique = paste0(recording_name, "_", trial_number, "_", media_name)) %>%
ungroup()%>%
group_by(recording_name, trial_number, media_name, age_months) %>%
mutate(new_noun_onset = case_when(abs(noun_onset) == min(abs(noun_onset)) ~ 0)) %>%
select(recording_name, trial_number, recording_timestamp, trial_from_zero, noun_onset, new_noun_onset, target, distractor, trackloss, age_months) %>%
mutate(parallel_timestamp = (row_number() - which(new_noun_onset == 0))*(1000/60),
parallel_timestamp = round(parallel_timestamp)) %>%
select(media_name, recording_name, trial_number, parallel_timestamp, target, distractor, trackloss, age_months) %>%
pivot_longer(c(target, distractor), names_to = "aoi", values_to = "value") %>%
arrange(recording_name, trial_number, aoi, parallel_timestamp) %>%
mutate(value = as.numeric(value)) %>%
filter(trackloss == FALSE) %>%
ungroup() %>%
mutate(age_group = case_when(age_months >= 14 & age_months < 21 ~ "14-20",
age_months >= 21 & age_months < 31 ~ "21-30",
age_months >= 31 & age_months < 51 ~ "31-48"))
copy_dat_fig1 <- copy_data %>%
group_by(recording_name, aoi, parallel_timestamp, age_group) %>%
summarise(mean_fixation = mean(value))
ggplot(copy_dat_fig1, aes(x=parallel_timestamp, y=mean_fixation, colour=aoi)) +
geom_vline(xintercept=0, linetype="dashed", colour="gray28") +
stat_summary(fun.data=mean_cl_boot, aes(fill=aoi),
geom="ribbon", alpha=.2, linetype="blank") +
stat_summary(fun=mean, geom="path",
aes(group=aoi, linetype=aoi), size=.7) + facet_wrap(~age_group)
copy_dat_stat <- copy_data %>%
filter(parallel_timestamp >= -1000 & parallel_timestamp <= 2500)
#Apply statistical test to each time point
copy_p_table <- dat_stat %>%
# select only rows in the dataframe where a fixation occurred
filter(value == 1) %>%
# label fixations that were on the target as 1 and as 0 otherwise,
mutate(looking_to_target = ifelse(aoi == "target", 1, 0)) %>%
# we want to test for each timepoint
group_by(parallel_timestamp) %>%
# apply logistic regression and extract z-values
summarise(z = summary(lme4::glmer(looking_to_target ~ 1 +
(1|recording_name), family="binomial",
control=lme4::glmerControl(calc.derivs=FALSE)))$coefficients[1,3]) %>%
# add p-values
mutate(p = pnorm(-abs(z))*2)
#Apply statistical test to each time point
copy_p_table <- copy_dat_stat %>%
# select only rows in the dataframe where a fixation occurred
filter(value == 1) %>%
# label fixations that were on the target as 1 and as 0 otherwise,
mutate(looking_to_target = ifelse(aoi == "target", 1, 0)) %>%
# we want to test for each timepoint
group_by(parallel_timestamp) %>%
# apply logistic regression and extract z-values
summarise(z = summary(lme4::glmer(looking_to_target ~ 1 +
(1|recording_name), family="binomial",
control=lme4::glmerControl(calc.derivs=FALSE)))$coefficients[1,3]) %>%
# add p-values
mutate(p = pnorm(-abs(z))*2)
View(copy_p_table)
# Set alpha level and calculate Bonferroni correction
alpha           <- 0.05
N_tests         <- length(unique(copy_dat_stat$parallel_timestamp))
alpha_corrected <- alpha/N_tests
# Find the earliest timepoint with a significant uncorrected p-value
(uncorr <- copy_p_table %>%
# extract positive z-scores ("target advantage") and significant p-values
filter(z > 0, p < alpha) %>%
# extract the earliest significant p-value and its timepoint
slice(1))
# Find the earliest timepoint that survives the Bonferroni correction
(bnf <- p_table %>%
filter(z > 0, p < alpha_corrected) %>%
slice(1))
# Find the earliest timepoint that survives the Bonferroni correction
(bnf <- copy_p_table %>%
filter(z > 0, p < alpha_corrected) %>%
slice(1))
# Find the earliest timepoint after FDR control
(fdr <- copy_p_table %>%
# apply FDR control from `stats` package
mutate(p_fdr = stats::p.adjust(p, method = "BY", n = length(p))) %>%
filter(z > 0, p_fdr < alpha) %>%
slice(1))
View(fdr)
View(uncorr)
View(bnf)
#This takes a little while to run because of the bootstrapping
base_plot <- ggplot(copy_dat_fig1, aes(x=parallel_timestamp, y=mean_fixation, colour=aoi)) +
geom_vline(xintercept=0, linetype="dashed", colour="gray28") +
stat_summary(fun.data=mean_cl_boot, aes(fill=aoi),
geom="ribbon", alpha=.2, linetype="blank") +
stat_summary(fun=mean, geom="path",
aes(group=aoi, linetype=aoi), size=.7) + facet_wrap(~age_group)
plot_points <- tibble(correction = c("Uncorrected", "Bonferroni", "FDR"),
parallel_timestamp = c(uncorr$parallel_timestamp), bnf$parallel_timestamp, fdr$parallel_timestamp,
y = .5)
plot_points <- tibble(correction = c("Uncorrected", "Bonferroni", "FDR"),
parallel_timestamp = c(uncorr$parallel_timestamp), bnf$parallel_timestamp, fdr$parallel_timestamp,
mean_fixation = .5)
base_plot +
geom_point(data = plot_points)
plot_points <- tibble(correction = c("Uncorrected", "Bonferroni", "FDR"),
parallel_timestamp = c(uncorr$parallel_timestamp), bnf$parallel_timestamp, fdr$parallel_timestamp,
mean_fixation = .5,
aoi = "target")
base_plot +
geom_point(data = plot_points)
base_plot +
geom_point(data = plot_points, color = "black")
View(plot_points)
plot_points <- tibble(correction = c("Uncorrected", "Bonferroni", "FDR"),
parallel_timestamp = c(uncorr$parallel_timestamp, bnf$parallel_timestamp, fdr$parallel_timestamp),
mean_fixation = .5,
aoi = "target")
base_plot +
geom_point(data = plot_points)
base_plot +
geom_point(data = plot_points, color = "black", aes(shape = plot_points$correction))
overall_plot <- ggplot(copy_dat_fig1, aes(x=parallel_timestamp, y=mean_fixation, colour=aoi)) +
geom_vline(xintercept=0, linetype="dashed", colour="gray28") +
stat_summary(fun.data=mean_cl_boot, aes(fill=aoi),
geom="ribbon", alpha=.2, linetype="blank") +
stat_summary(fun=mean, geom="path",
aes(group=aoi, linetype=aoi), size=.7) +
geom_point(data = plot_points, color = "black", aes(shape = plot_points$correction))
overall_plot
