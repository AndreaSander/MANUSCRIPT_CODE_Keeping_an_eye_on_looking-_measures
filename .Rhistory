)%>%
mutate(cohen_d =
(experimental_study_mean-NONexperimental_study_mean)/pooled_sd)%>%
mutate(SE=sqrt( ((n_experimental+n_non_experimental)/(n_experimental*n_non_experimental))+
((cohen_d^2)/(2*(n_experimental+n_non_experimental)))
)
) %>%
mutate(CI_lower = (cohen_d-(crit_value*SE))) %>%
mutate(CI_upper = (cohen_d+(crit_value*SE)))
#create a mini dataframe to later create a table with all the effects
mean_pupil_size_d <- mean_pupil_size_for_d %>%
mutate(variable="mean_pupil_size_difference")%>%
dplyr::select(study, variable, cohen_d, SE, CI_lower, CI_upper)
#######
pupil_latency_for_d <- mean_by_study %>%
dplyr::select(mean_peak_pupil_latency_experimental, mean_peak_pupil_latency_NONexperimental,
recording_name, study) %>%
group_by(study) %>%
summarise(experimental_study_mean= mean(mean_peak_pupil_latency_experimental, na.rm=T),
NONexperimental_study_mean= mean(mean_peak_pupil_latency_NONexperimental, na.rm=T),
experimental_study_sd= sd(mean_peak_pupil_latency_experimental, na.rm=T),
NONexperimental_study_sd= sd(mean_peak_pupil_latency_NONexperimental, na.rm=T),
n_experimental = sum(!is.na(mean_peak_pupil_latency_experimental)),
n_non_experimental = sum(!is.na(`mean_peak_pupil_latency_NONexperimental`))
) %>%
mutate(pooled_sd =
sqrt((((n_experimental-1)*(experimental_study_sd^2))+((n_non_experimental-1)*(NONexperimental_study_sd^2)))/((n_experimental+n_non_experimental)-2))
)%>%
mutate(cohen_d =
(experimental_study_mean-NONexperimental_study_mean)/pooled_sd)%>%
mutate(SE=sqrt( ((n_experimental+n_non_experimental)/(n_experimental*n_non_experimental))+
((cohen_d^2)/(2*(n_experimental+n_non_experimental)))
)
) %>%
mutate(CI_lower = (cohen_d-(crit_value*SE))) %>%
mutate(CI_upper = (cohen_d+(crit_value*SE)))
#create a mini dataframe to later create a table with all the effects
pupil_latency_d <- pupil_latency_for_d %>%
mutate(variable="peak_pupil_latency")%>%
dplyr::select(study, variable, cohen_d, SE, CI_lower, CI_upper)
###########
first_look_dur_for_d <- mean_by_study %>%
dplyr::select(mean_first_look_dur_experimental, mean_first_look_dur_NONexperimental,
recording_name, study) %>%
group_by(study) %>%
summarise(experimental_study_mean= mean(mean_first_look_dur_experimental, na.rm=T),
NONexperimental_study_mean= mean(mean_first_look_dur_NONexperimental, na.rm=T),
experimental_study_sd= sd(mean_first_look_dur_experimental, na.rm=T),
NONexperimental_study_sd= sd(mean_first_look_dur_NONexperimental, na.rm=T),
n_experimental = sum(!is.na(mean_first_look_dur_experimental)),
n_non_experimental = sum(!is.na(`mean_first_look_dur_NONexperimental`))
) %>%
mutate(pooled_sd =
sqrt((((n_experimental-1)*(experimental_study_sd^2))+((n_non_experimental-1)*(NONexperimental_study_sd^2)))/((n_experimental+n_non_experimental)-2))
)%>%
mutate(cohen_d =
(experimental_study_mean-NONexperimental_study_mean)/pooled_sd)%>%
mutate(SE=sqrt( ((n_experimental+n_non_experimental)/(n_experimental*n_non_experimental))+
((cohen_d^2)/(2*(n_experimental+n_non_experimental)))
)
) %>%
mutate(CI_lower = (cohen_d-(crit_value*SE))) %>%
mutate(CI_upper = (cohen_d+(crit_value*SE)))
#create a mini dataframe to later create a table with all the effects
first_look_duration_d <- first_look_dur_for_d %>%
mutate(variable="first_look_duration")%>%
dplyr::select(study, variable, cohen_d, SE, CI_lower, CI_upper)
#Create cohen's d table #Note: for the paper make sure to organize the table by study
all_dvs_c<- rbind(first_look_duration_d, pupil_latency_d, mean_pupil_size_d, peak_pupil_d, aoi_switches_d, duration_look_d, RT_d, prop_looking_d, prop_looking_diff_d, shift_target_d, shift_distractor_d, num_fixations_d)
# #Create cohen's d visualization
# library(forestploter)
#
#
#
#
#
#
# d<- ggplot(all_dvs_c, aes(variable, absolute_cohen_d, fill=study))
#
# d+geom_dotplot(position="jitter")+ theme(axis.text.x = element_text(angle = 45))
# #NOTE
# #These kids are in the experimental dataset but not the non-experimental one, so cannot calculate Cohen's D:
# experimental_means_sds %>% filter(recording_name %notin% non_experimental_means_sds$recording_name) %>% count(recording_name)
# #These kids are in the non-experimental dataset but not the experimental one, so cannot calculate Cohen's D:
# non_experimental_means_sds %>% filter(recording_name %notin% experimental_means_sds$recording_name) %>% count(recording_name)
View(all_dvs_c)
# #Create cohen's d visualization
library(forestplot)
# #Create cohen's d visualization
library(forestploter)
forest(all_dvs_c, est=cohen_d, lower=CI_lower, upper = CI_upper, sizes=SE, ci_column = 4, ref_line = 0, xlim=c(-1,1))
forest(all_dvs_c, est="cohen_d", lower="CI_lower", upper = "CI_upper", sizes="SE", ci_column = 4, ref_line = 0, xlim=c(-1,1))
str(all_dvs_c)
forest(all_dvs_c, est=all_dvs_c$cohen_d, lower=all_dvs_c$CI_lower, upper = all_dvs_c$CI_upper, sizes=all_dvs_c$SE, ci_column = 4, ref_line = 0, xlim=c(-1,1))
forest(all_dvs_c, est=all_dvs_c$cohen_d, lower=all_dvs_c$CI_lower, upper = all_dvs_c$CI_upper, sizes=all_dvs_c$SE, ci_column = 4, ref_line = 0, xlim=c(-2,2))
all_dvs_c<- rbind(first_look_duration_d, pupil_latency_d, mean_pupil_size_d, peak_pupil_d, aoi_switches_d, duration_look_d, RT_d, prop_looking_d, prop_looking_diff_d, shift_target_d, shift_distractor_d, num_fixations_d) %>%
group_by(study)
forest(all_dvs_c, est=all_dvs_c$cohen_d, lower=all_dvs_c$CI_lower, upper = all_dvs_c$CI_upper, sizes=all_dvs_c$SE, ci_column = 4, ref_line = 0, xlim=c(-2,2))
all_dvs_c<- rbind(first_look_duration_d, pupil_latency_d, mean_pupil_size_d, peak_pupil_d, aoi_switches_d, duration_look_d, RT_d, prop_looking_d, prop_looking_diff_d, shift_target_d, shift_distractor_d, num_fixations_d) %>%
ungroup()%>%
group_by(study)
all_dvs_c<- rbind(first_look_duration_d, pupil_latency_d, mean_pupil_size_d, peak_pupil_d, aoi_switches_d, duration_look_d, RT_d, prop_looking_d, prop_looking_diff_d, shift_target_d, shift_distractor_d, num_fixations_d) %>%
ungroup()%>%
group_by(study, variable)
View(all_dvs_c)
all_dvs_c<- rbind(first_look_duration_d, pupil_latency_d, mean_pupil_size_d, peak_pupil_d, aoi_switches_d, duration_look_d, RT_d, prop_looking_d, prop_looking_diff_d, shift_target_d, shift_distractor_d, num_fixations_d) %>%
ungroup()
test<-all_dvs_c %>%
group_by(study)
View(test)
test<-all_dvs_c %>%
group_by(c(study,variable))
test<-all_dvs_c %>%
group_by(all_dvs_c$study)
#If this throws an error, it probably means the by-subject means and SDs file hasn't been generated. Run the script without this chunk to generate it, then try again using the opposite analysis type variable.
experimental_means_sds <- read_csv(here("by_subject_means_sds_experimental.csv"))
non_experimental_means_sds <- read_csv(here("by_subject_means_sds_non-experimental.csv"))
for_cohens_d <- experimental_means_sds %>%
inner_join(non_experimental_means_sds, by="recording_name")
#First create a dataset with by study information that we can use to calculate a by study Cohens'D
mean_by_study <- for_cohens_d %>%
ungroup() %>%
mutate(study = sub("_.*", "", recording_name)) %>%
mutate(study = case_when(str_detect(recording_name, "Mix_14")~"Mix14",
str_detect(recording_name, "Mix_20")~"Mix20",
TRUE~ study)
)
#changeing the default nomenclature of inner join, to column names that will make sense
colnames(mean_by_study) <- gsub("\\.y$", "_NONexperimental", colnames(mean_by_study))
colnames(mean_by_study) <- gsub("\\.x$", "_experimental", colnames(mean_by_study))
#Then create separate datasets for the each DV to get a mean and a dv by study by condition to be able to calculate cohen's D
#establish a critical value for alfa = 0.05 to later calculate 95% confidence intervals
crit_value<- qnorm(1-((0.05)/(2)))
prop_looking_for_d <- mean_by_study %>%
dplyr::select(mean_prop_looking_experimental, mean_prop_looking_NONexperimental,
recording_name, study) %>%
group_by(study) %>%
summarise(experimental_study_mean= mean(mean_prop_looking_experimental, na.rm=T),
NONexperimental_study_mean= mean(mean_prop_looking_NONexperimental, na.rm=T),
experimental_study_sd= sd(mean_prop_looking_experimental, na.rm=T),
NONexperimental_study_sd= sd(mean_prop_looking_NONexperimental, na.rm=T),
n_experimental = sum(!is.na(mean_prop_looking_experimental)),
n_non_experimental = sum(!is.na(`mean_prop_looking_NONexperimental`))
) %>%
mutate(pooled_sd =
sqrt((((n_experimental-1)*(experimental_study_sd^2))+((n_non_experimental-1)*(NONexperimental_study_sd^2)))/((n_experimental+n_non_experimental)-2))
)%>%
mutate(cohen_d =
(experimental_study_mean-NONexperimental_study_mean)/pooled_sd) %>%
mutate(SE=sqrt( ((n_experimental+n_non_experimental)/(n_experimental*n_non_experimental))+
((cohen_d^2)/(2*(n_experimental+n_non_experimental)))
)
) %>%
mutate(CI_lower = (cohen_d-(crit_value*SE))) %>%
mutate(CI_upper = (cohen_d+(crit_value*SE)))
#create a mini dataframe to later create a table with all the effects
prop_looking_d <- prop_looking_for_d %>%
mutate(variable="prop_looking")%>%
dplyr::select(study, variable, cohen_d, SE, CI_lower, CI_upper)
########
prop_looking_diff_for_d <- mean_by_study %>%
dplyr::select(mean_prop_looking_diff_experimental, mean_prop_looking_diff_NONexperimental,
recording_name, study) %>%
group_by(study) %>%
summarise(experimental_study_mean= mean(mean_prop_looking_diff_experimental, na.rm=T),
NONexperimental_study_mean= mean(mean_prop_looking_diff_NONexperimental, na.rm=T),
experimental_study_sd= sd(mean_prop_looking_diff_experimental, na.rm=T),
NONexperimental_study_sd= sd(mean_prop_looking_diff_NONexperimental, na.rm=T),
n_experimental = sum(!is.na(mean_prop_looking_diff_experimental)),
n_non_experimental = sum(!is.na(`mean_prop_looking_diff_NONexperimental`))
) %>%
mutate(pooled_sd =
sqrt((((n_experimental-1)*(experimental_study_sd^2))+((n_non_experimental-1)*(NONexperimental_study_sd^2)))/((n_experimental+n_non_experimental)-2))
)%>%
mutate(cohen_d =
(experimental_study_mean-NONexperimental_study_mean)/pooled_sd)%>%
mutate(SE=sqrt( ((n_experimental+n_non_experimental)/(n_experimental*n_non_experimental))+
((cohen_d^2)/(2*(n_experimental+n_non_experimental)))
)
) %>%
mutate(CI_lower = (cohen_d-(crit_value*SE))) %>%
mutate(CI_upper = (cohen_d+(crit_value*SE)))
#create a mini dataframe to later create a table with all the effects
prop_looking_diff_d <- prop_looking_diff_for_d %>%
mutate(variable="prop_looking_diff")%>%
dplyr::select(study, variable, cohen_d, SE, CI_lower, CI_upper)
#################
num_fixations_for_d <- mean_by_study %>%
dplyr::select(mean_number_fixations_experimental, mean_number_fixations_NONexperimental,
recording_name, study) %>%
group_by(study) %>%
summarise(experimental_study_mean= mean(mean_number_fixations_experimental, na.rm=T),
NONexperimental_study_mean= mean(mean_number_fixations_NONexperimental, na.rm=T),
experimental_study_sd= sd(mean_number_fixations_experimental, na.rm=T),
NONexperimental_study_sd= sd(mean_number_fixations_NONexperimental, na.rm=T),
n_experimental = sum(!is.na(mean_number_fixations_experimental)),
n_non_experimental = sum(!is.na(`mean_number_fixations_NONexperimental`))
) %>%
mutate(pooled_sd =
sqrt((((n_experimental-1)*(experimental_study_sd^2))+((n_non_experimental-1)*(NONexperimental_study_sd^2)))/((n_experimental+n_non_experimental)-2))
)%>%
mutate(cohen_d =
(experimental_study_mean-NONexperimental_study_mean)/pooled_sd)%>%
mutate(SE=sqrt( ((n_experimental+n_non_experimental)/(n_experimental*n_non_experimental))+
((cohen_d^2)/(2*(n_experimental+n_non_experimental)))
)
) %>%
mutate(CI_lower = (cohen_d-(crit_value*SE))) %>%
mutate(CI_upper = (cohen_d+(crit_value*SE)))
#create a mini dataframe to later create a table with all the effects
num_fixations_d <- num_fixations_for_d  %>%
mutate(variable="number_fixations")%>%
dplyr::select(study, variable, cohen_d, SE, CI_lower, CI_upper)
#########
shift_distractor_for_d <- mean_by_study %>%
dplyr::select(prop_shift_distractor_initial_experimental, prop_shift_distractor_initial_NONexperimental,
recording_name, study) %>%
group_by(study) %>%
summarise(experimental_study_mean= mean(prop_shift_distractor_initial_experimental, na.rm=T),
NONexperimental_study_mean= mean(prop_shift_distractor_initial_NONexperimental, na.rm=T),
experimental_study_sd= sd(prop_shift_distractor_initial_experimental, na.rm=T),
NONexperimental_study_sd= sd(prop_shift_distractor_initial_NONexperimental, na.rm=T),
n_experimental = sum(!is.na(prop_shift_distractor_initial_experimental)),
n_non_experimental = sum(!is.na(`prop_shift_distractor_initial_NONexperimental`))
) %>%
mutate(pooled_sd =
sqrt((((n_experimental-1)*(experimental_study_sd^2))+((n_non_experimental-1)*(NONexperimental_study_sd^2)))/((n_experimental+n_non_experimental)-2))
)%>%
mutate(cohen_d =
(experimental_study_mean-NONexperimental_study_mean)/pooled_sd)%>%
mutate(SE=sqrt( ((n_experimental+n_non_experimental)/(n_experimental*n_non_experimental))+
((cohen_d^2)/(2*(n_experimental+n_non_experimental)))
)
) %>%
mutate(CI_lower = (cohen_d-(crit_value*SE))) %>%
mutate(CI_upper = (cohen_d+(crit_value*SE)))
#create a mini dataframe to later create a table with all the effects
shift_distractor_d <- shift_distractor_for_d %>%
mutate(variable="prop_shift_distractor_initial")%>%
dplyr::select(study, variable, cohen_d, SE, CI_lower, CI_upper)
##############
shift_target_for_d <- mean_by_study %>%
dplyr::select(mean_prop_shift_target_initial_experimental, mean_prop_shift_target_initial_NONexperimental,
recording_name, study) %>%
group_by(study) %>%
summarise(experimental_study_mean= mean(mean_prop_shift_target_initial_experimental, na.rm=T),
NONexperimental_study_mean= mean(mean_prop_shift_target_initial_NONexperimental, na.rm=T),
experimental_study_sd= sd(mean_prop_shift_target_initial_experimental, na.rm=T),
NONexperimental_study_sd= sd(mean_prop_shift_target_initial_NONexperimental, na.rm=T),
n_experimental = sum(!is.na(mean_prop_shift_target_initial_experimental)),
n_non_experimental = sum(!is.na(`mean_prop_shift_target_initial_NONexperimental`))
) %>%
mutate(pooled_sd =
sqrt((((n_experimental-1)*(experimental_study_sd^2))+((n_non_experimental-1)*(NONexperimental_study_sd^2)))/((n_experimental+n_non_experimental)-2))
)%>%
mutate(cohen_d =
(experimental_study_mean-NONexperimental_study_mean)/pooled_sd)%>%
mutate(SE=sqrt( ((n_experimental+n_non_experimental)/(n_experimental*n_non_experimental))+
((cohen_d^2)/(2*(n_experimental+n_non_experimental)))
)
) %>%
mutate(CI_lower = (cohen_d-(crit_value*SE))) %>%
mutate(CI_upper = (cohen_d+(crit_value*SE)))
#create a mini dataframe to later create a table with all the effects
shift_target_d <- shift_target_for_d%>%
mutate(variable="prop_shift_target_initial")%>%
dplyr::select(study, variable, cohen_d, SE, CI_lower, CI_upper)
##########
RT_for_d <- mean_by_study %>%
dplyr::select(mean_RT_experimental, mean_RT_NONexperimental,
recording_name, study) %>%
group_by(study) %>%
summarise(experimental_study_mean= mean(mean_RT_experimental, na.rm=T),
NONexperimental_study_mean= mean(mean_RT_NONexperimental, na.rm=T),
experimental_study_sd= sd(mean_RT_experimental, na.rm=T),
NONexperimental_study_sd= sd(mean_RT_NONexperimental, na.rm=T),
n_experimental = sum(!is.na(mean_RT_experimental)),
n_non_experimental = sum(!is.na(`mean_RT_NONexperimental`))
) %>%
mutate(pooled_sd =
sqrt((((n_experimental-1)*(experimental_study_sd^2))+((n_non_experimental-1)*(NONexperimental_study_sd^2)))/((n_experimental+n_non_experimental)-2))
)%>%
mutate(cohen_d =
(experimental_study_mean-NONexperimental_study_mean)/pooled_sd)%>%
mutate(SE=sqrt( ((n_experimental+n_non_experimental)/(n_experimental*n_non_experimental))+
((cohen_d^2)/(2*(n_experimental+n_non_experimental)))
)
) %>%
mutate(CI_lower = (cohen_d-(crit_value*SE))) %>%
mutate(CI_upper = (cohen_d+(crit_value*SE)))
#create a mini dataframe to later create a table with all the effects
RT_d <- RT_for_d %>%
mutate(variable="RT")%>%
dplyr::select(study, variable, cohen_d, SE, CI_lower, CI_upper)
#############
AOI_switches_for_d <- mean_by_study %>%
dplyr::select(total_aoi_switches_experimental, total_aoi_switches_NONexperimental,
recording_name, study) %>%
group_by(study) %>%
summarise(experimental_study_mean= mean(total_aoi_switches_experimental, na.rm=T),
NONexperimental_study_mean= mean(total_aoi_switches_NONexperimental, na.rm=T),
experimental_study_sd= sd(total_aoi_switches_experimental, na.rm=T),
NONexperimental_study_sd= sd(total_aoi_switches_NONexperimental, na.rm=T),
n_experimental = sum(!is.na(total_aoi_switches_experimental)),
n_non_experimental = sum(!is.na(`total_aoi_switches_NONexperimental`))
) %>%
mutate(pooled_sd =
sqrt((((n_experimental-1)*(experimental_study_sd^2))+((n_non_experimental-1)*(NONexperimental_study_sd^2)))/((n_experimental+n_non_experimental)-2))
)%>%
mutate(cohen_d =
(experimental_study_mean-NONexperimental_study_mean)/pooled_sd)%>%
mutate(SE=sqrt( ((n_experimental+n_non_experimental)/(n_experimental*n_non_experimental))+
((cohen_d^2)/(2*(n_experimental+n_non_experimental)))
)
) %>%
mutate(CI_lower = (cohen_d-(crit_value*SE))) %>%
mutate(CI_upper = (cohen_d+(crit_value*SE)))
#create a mini dataframe to later create a table with all the effects
aoi_switches_d <- AOI_switches_for_d %>%
mutate(variable="aoi_switches")%>%
dplyr::select(study, variable, cohen_d, SE, CI_lower, CI_upper)
###########
duration_look_for_d <- mean_by_study %>%
dplyr::select(mean_duration_of_look_experimental, mean_duration_of_look_NONexperimental,
recording_name, study) %>%
group_by(study) %>%
summarise(experimental_study_mean= mean(mean_duration_of_look_experimental, na.rm=T),
NONexperimental_study_mean= mean(mean_duration_of_look_NONexperimental, na.rm=T),
experimental_study_sd= sd(mean_duration_of_look_experimental, na.rm=T),
NONexperimental_study_sd= sd(mean_duration_of_look_NONexperimental, na.rm=T),
n_experimental = sum(!is.na(mean_duration_of_look_experimental)),
n_non_experimental = sum(!is.na(`mean_duration_of_look_NONexperimental`))
) %>%
mutate(pooled_sd =
sqrt((((n_experimental-1)*(experimental_study_sd^2))+((n_non_experimental-1)*(NONexperimental_study_sd^2)))/((n_experimental+n_non_experimental)-2))
)%>%
mutate(cohen_d =
(experimental_study_mean-NONexperimental_study_mean)/pooled_sd)%>%
mutate(SE=sqrt( ((n_experimental+n_non_experimental)/(n_experimental*n_non_experimental))+
((cohen_d^2)/(2*(n_experimental+n_non_experimental)))
)
) %>%
mutate(CI_lower = (cohen_d-(crit_value*SE))) %>%
mutate(CI_upper = (cohen_d+(crit_value*SE)))
#create a mini dataframe to later create a table with all the effects
duration_look_d <- duration_look_for_d %>%
mutate(variable="duration_look")%>%
dplyr::select(study, variable, cohen_d, SE, CI_lower, CI_upper)
##########
pupil_size_for_d <- mean_by_study %>%
dplyr::select(mean_peak_pupil_size_difference_experimental, mean_peak_pupil_size_difference_NONexperimental,
recording_name, study) %>%
group_by(study) %>%
summarise(experimental_study_mean= mean(mean_peak_pupil_size_difference_experimental, na.rm=T),
NONexperimental_study_mean= mean(mean_peak_pupil_size_difference_NONexperimental, na.rm=T),
experimental_study_sd= sd(mean_peak_pupil_size_difference_experimental, na.rm=T),
NONexperimental_study_sd= sd(mean_peak_pupil_size_difference_NONexperimental, na.rm=T),
n_experimental = sum(!is.na(mean_peak_pupil_size_difference_experimental)),
n_non_experimental = sum(!is.na(`mean_peak_pupil_size_difference_NONexperimental`))
) %>%
mutate(pooled_sd =
sqrt((((n_experimental-1)*(experimental_study_sd^2))+((n_non_experimental-1)*(NONexperimental_study_sd^2)))/((n_experimental+n_non_experimental)-2))
)%>%
mutate(cohen_d =
(experimental_study_mean-NONexperimental_study_mean)/pooled_sd)%>%
mutate(SE=sqrt( ((n_experimental+n_non_experimental)/(n_experimental*n_non_experimental))+
((cohen_d^2)/(2*(n_experimental+n_non_experimental)))
)
) %>%
mutate(CI_lower = (cohen_d-(crit_value*SE))) %>%
mutate(CI_upper = (cohen_d+(crit_value*SE)))
#create a mini dataframe to later create a table with all the effects
peak_pupil_d <- pupil_size_for_d  %>%
mutate(variable="mean_peak_pupil_size_difference")%>%
dplyr::select(study, variable, cohen_d, SE, CI_lower, CI_upper)
##############
mean_pupil_size_for_d <- mean_by_study %>%
dplyr::select(mean_mean_pupil_size_difference_experimental, mean_mean_pupil_size_difference_NONexperimental,
recording_name, study) %>%
group_by(study) %>%
summarise(experimental_study_mean= mean(mean_mean_pupil_size_difference_experimental, na.rm=T),
NONexperimental_study_mean= mean(mean_mean_pupil_size_difference_NONexperimental, na.rm=T),
experimental_study_sd= sd(mean_mean_pupil_size_difference_experimental, na.rm=T),
NONexperimental_study_sd= sd(mean_mean_pupil_size_difference_NONexperimental, na.rm=T),
n_experimental = sum(!is.na(mean_mean_pupil_size_difference_experimental)),
n_non_experimental = sum(!is.na(`mean_mean_pupil_size_difference_NONexperimental`))
) %>%
mutate(pooled_sd =
sqrt((((n_experimental-1)*(experimental_study_sd^2))+((n_non_experimental-1)*(NONexperimental_study_sd^2)))/((n_experimental+n_non_experimental)-2))
)%>%
mutate(cohen_d =
(experimental_study_mean-NONexperimental_study_mean)/pooled_sd)%>%
mutate(SE=sqrt( ((n_experimental+n_non_experimental)/(n_experimental*n_non_experimental))+
((cohen_d^2)/(2*(n_experimental+n_non_experimental)))
)
) %>%
mutate(CI_lower = (cohen_d-(crit_value*SE))) %>%
mutate(CI_upper = (cohen_d+(crit_value*SE)))
#create a mini dataframe to later create a table with all the effects
mean_pupil_size_d <- mean_pupil_size_for_d %>%
mutate(variable="mean_pupil_size_difference")%>%
dplyr::select(study, variable, cohen_d, SE, CI_lower, CI_upper)
#######
pupil_latency_for_d <- mean_by_study %>%
dplyr::select(mean_peak_pupil_latency_experimental, mean_peak_pupil_latency_NONexperimental,
recording_name, study) %>%
group_by(study) %>%
summarise(experimental_study_mean= mean(mean_peak_pupil_latency_experimental, na.rm=T),
NONexperimental_study_mean= mean(mean_peak_pupil_latency_NONexperimental, na.rm=T),
experimental_study_sd= sd(mean_peak_pupil_latency_experimental, na.rm=T),
NONexperimental_study_sd= sd(mean_peak_pupil_latency_NONexperimental, na.rm=T),
n_experimental = sum(!is.na(mean_peak_pupil_latency_experimental)),
n_non_experimental = sum(!is.na(`mean_peak_pupil_latency_NONexperimental`))
) %>%
mutate(pooled_sd =
sqrt((((n_experimental-1)*(experimental_study_sd^2))+((n_non_experimental-1)*(NONexperimental_study_sd^2)))/((n_experimental+n_non_experimental)-2))
)%>%
mutate(cohen_d =
(experimental_study_mean-NONexperimental_study_mean)/pooled_sd)%>%
mutate(SE=sqrt( ((n_experimental+n_non_experimental)/(n_experimental*n_non_experimental))+
((cohen_d^2)/(2*(n_experimental+n_non_experimental)))
)
) %>%
mutate(CI_lower = (cohen_d-(crit_value*SE))) %>%
mutate(CI_upper = (cohen_d+(crit_value*SE)))
#create a mini dataframe to later create a table with all the effects
pupil_latency_d <- pupil_latency_for_d %>%
mutate(variable="peak_pupil_latency")%>%
dplyr::select(study, variable, cohen_d, SE, CI_lower, CI_upper)
###########
first_look_dur_for_d <- mean_by_study %>%
dplyr::select(mean_first_look_dur_experimental, mean_first_look_dur_NONexperimental,
recording_name, study) %>%
group_by(study) %>%
summarise(experimental_study_mean= mean(mean_first_look_dur_experimental, na.rm=T),
NONexperimental_study_mean= mean(mean_first_look_dur_NONexperimental, na.rm=T),
experimental_study_sd= sd(mean_first_look_dur_experimental, na.rm=T),
NONexperimental_study_sd= sd(mean_first_look_dur_NONexperimental, na.rm=T),
n_experimental = sum(!is.na(mean_first_look_dur_experimental)),
n_non_experimental = sum(!is.na(`mean_first_look_dur_NONexperimental`))
) %>%
mutate(pooled_sd =
sqrt((((n_experimental-1)*(experimental_study_sd^2))+((n_non_experimental-1)*(NONexperimental_study_sd^2)))/((n_experimental+n_non_experimental)-2))
)%>%
mutate(cohen_d =
(experimental_study_mean-NONexperimental_study_mean)/pooled_sd)%>%
mutate(SE=sqrt( ((n_experimental+n_non_experimental)/(n_experimental*n_non_experimental))+
((cohen_d^2)/(2*(n_experimental+n_non_experimental)))
)
) %>%
mutate(CI_lower = (cohen_d-(crit_value*SE))) %>%
mutate(CI_upper = (cohen_d+(crit_value*SE)))
#create a mini dataframe to later create a table with all the effects
first_look_duration_d <- first_look_dur_for_d %>%
mutate(variable="first_look_duration")%>%
dplyr::select(study, variable, cohen_d, SE, CI_lower, CI_upper)
#Create cohen's d table #Note: for the paper make sure to organize the table by study
all_dvs_c<- rbind(first_look_duration_d, pupil_latency_d, mean_pupil_size_d, peak_pupil_d, aoi_switches_d, duration_look_d, RT_d, prop_looking_d, prop_looking_diff_d, shift_target_d, shift_distractor_d, num_fixations_d) %>%
group_by(study)
# #Create cohen's d visualization
library(forestploter)
forest(all_dvs_c, est=all_dvs_c$cohen_d, lower=all_dvs_c$CI_lower, upper = all_dvs_c$CI_upper, sizes=all_dvs_c$SE, ci_column = 4, ref_line = 0, xlim=c(-2,2))
# #NOTE
# #These kids are in the experimental dataset but not the non-experimental one, so cannot calculate Cohen's D:
# experimental_means_sds %>% filter(recording_name %notin% non_experimental_means_sds$recording_name) %>% count(recording_name)
# #These kids are in the non-experimental dataset but not the experimental one, so cannot calculate Cohen's D:
# non_experimental_means_sds %>% filter(recording_name %notin% experimental_means_sds$recording_name) %>% count(recording_name)
View(all_dvs_c)
all_dvs_c<- rbind(first_look_duration_d, pupil_latency_d, mean_pupil_size_d, peak_pupil_d, aoi_switches_d, duration_look_d, RT_d, prop_looking_d, prop_looking_diff_d, shift_target_d, shift_distractor_d, num_fixations_d) %>%
group_by(study)
library(tidylog)
all_dvs_c<- rbind(first_look_duration_d, pupil_latency_d, mean_pupil_size_d, peak_pupil_d, aoi_switches_d, duration_look_d, RT_d, prop_looking_d, prop_looking_diff_d, shift_target_d, shift_distractor_d, num_fixations_d) %>%
group_by(study)
?forest
d+geom_point()+
geom_errorbarh(aes(xmin=all_dvs_c$CI_lower, xmax=all_dvs_c$CI_upper))
# #Create cohen's d visualization
d<- ggplot(all_dvs_c, aes(x=cohen_d, y=variable, fill=study))
d+geom_point()+
geom_errorbarh(aes(xmin=all_dvs_c$CI_lower, xmax=all_dvs_c$CI_upper))
# #Create cohen's d visualization
d<- ggplot(all_dvs_c, aes(x=cohen_d, y=variable, color=factor(study)))
d+geom_point()+
geom_errorbarh(aes(xmin=all_dvs_c$CI_lower, xmax=all_dvs_c$CI_upper))
d+geom_point(size=3)+
geom_errorbarh(aes(xmin=all_dvs_c$CI_lower, xmax=all_dvs_c$CI_upper))+
theme_minimal()+
scale_x_continuous(limits = c(-2,2))
d+geom_point(size=3)+
geom_errorbarh(aes(xmin=all_dvs_c$CI_lower, xmax=all_dvs_c$CI_upper))+
geom_point(mean(all_dvs_c$cohen_d), shape=18, size=4, color="black")
d+geom_point(size=3)+
geom_errorbarh(aes(xmin=all_dvs_c$CI_lower, xmax=all_dvs_c$CI_upper))+
geom_point(aes(mean(all_dvs_c$cohen_d)), shape=18, size=4, color="black")
d+geom_point(size=3)+
geom_errorbarh(aes(xmin=all_dvs_c$CI_lower, xmax=all_dvs_c$CI_upper))+
geom_point(aes(mean(all_dvs_c$cohen_d)), shape=18, size=4, color="black")+
theme_minimal()+
scale_x_continuous(limits = c(-2,2))
d+geom_point(size=3)+
geom_errorbarh(aes(xmin=all_dvs_c$CI_lower, xmax=all_dvs_c$CI_upper))+
theme_minimal()+
scale_x_continuous(limits = c(-2,2))
d_mean<- all_dvs_c %>%
ungroup()%>%
group_by(variable) %>%
summarize(mean_d= mean(cohen_d))
d+geom_point(size=3)+
geom_errorbarh(aes(xmin=all_dvs_c$CI_lower, xmax=all_dvs_c$CI_upper))+
geom_point(data = d_mean, aes(x = mean_d, y = variable), shape = 18, size = 4, color = "black") +
theme_minimal()+
scale_x_continuous(limits = c(-2,2))
